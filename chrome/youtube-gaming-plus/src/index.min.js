!function(){const t=/https:\/\/www\.youtube\.com/i,e=/https:\/\/www\.youtube\.com\/watch\?v=/i,i=/https:\/\/www\.youtube\.com\/*(.+)\/live/i,r=visualSettingsKey;let o=!1,s=!1,n=!1,a={...defaultVisualSettings},c,l="",d,u=-1,y=void 0;const m=()=>Utils.canRun(e,document.location.href)||Utils.canRun(i,document.location.href),h=()=>{const t=document.querySelector("ytd-live-chat-frame");return Utils.exists(t)&&!t.hasAttribute("hidden")};const p=()=>{var t=document.querySelector("ytd-channel-name > #container > #text-container > yt-formatted-string > a");return Utils.exists(t)?t.innerText:""},b=()=>{const e=p().toLowerCase();var t=supportedChannels.find(t=>t.youtube.name===e);return Utils.exists(t)&&!t.youtube.enable},v=()=>{const t=document.querySelector(".ytg-title");if(h()){var e=document.querySelector("ytd-video-primary-info-renderer h1 > yt-formatted-string");const i=document.querySelector(".html5-video-player .html5-video-container");c=e.innerText,Utils.exists(i)&&(Utils.exists(t)?t.innerText=""+c:i.insertBefore(((t="")=>{const e=document.createElement("template");return e.innerHTML=`<div class="ytg-top-bar"><h1 class="title style-scope ytd-video-primary-info-renderer ytg-title">${t} <span class='style-scope ytd-video-view-count-renderer ytg-title-views'></span></h1></div>`,e.innerText=t,e.content})(c),i.childNodes[0]))}else Utils.exists(t)&&t.remove()},g=()=>{if(h()){const e=document.querySelector("ytd-video-view-count-renderer > .view-count");if(Utils.exists(e)){var t=""===l?" ":` ${l} `;const i=document.querySelector(".ytg-title-views");d=e.innerText.split(" ")[0],Utils.exists(i)&&(""===d?i.innerText="Streaming"+t:i.innerText=`Streaming${t}for ${d} viewers`)}}},f=()=>{var t;h()&&(t=document.querySelector("ytd-rich-metadata-renderer #title"),l=Utils.exists(t)?t.innerText:"")},x=()=>{const t=document.querySelector("video.video-stream.html5-main-video");Utils.exists(t)&&(t.style.setProperty("width",t.parentElement.scrollWidth+"px"),t.style.setProperty("height",t.parentElement.scrollHeight+"px"),t.style.setProperty("left","0px"),t.style.setProperty("top","0px"))},S=t=>{Utils.exists(t)&&Utils.exists(document.body)&&(t.hasAttribute("collapsed")?document.body.hasAttribute("ytg-hide-chat")||document.body.setAttribute("ytg-hide-chat",""):document.body.hasAttribute("ytg-hide-chat")&&document.body.removeAttribute("ytg-hide-chat"),window.dispatchEvent(new CustomEvent("updateChatCollapsed",{detail:{collapsed:!0},bubbles:!0})))},w=new MutationObserver((t,e)=>{v()}),U=new MutationObserver((t,e)=>{g()}),O=new MutationObserver((t,e)=>{f()}),q=new MutationObserver(t=>{for(const i of t){var e;"attributes"===i.type&&(e=i.target,Utils.exists(e)&&s&&S(i.target))}}),A=()=>{if(s&&(n="visible"===document.visibilityState,a.qualityOptimization)){if("visible"===document.visibilityState&&y)return y.click(),u=-1,void(y=void 0);const i=document.querySelector("#player-container .ytp-chrome-bottom button.ytp-button.ytp-settings-button");if(Utils.exists(i)){i.click();const t=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem")).at(-1);Utils.exists(t)&&(t.click(),"visible"===document.visibilityState?setTimeout(()=>{const t=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem")),e=t.at(u);(Utils.exists(e)?e:i).click()},500):setTimeout(()=>{const e=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem"));for(let t=0;t<e.length-1;t++){var i=e.at(t);(i.ariaChecked||i.ariaSelected)&&(u=t,y=i)}const t=e.at(-2);Utils.exists(t)&&t.click()},200))}}},T=()=>{m()&&(void 0!==C&&C.disconnect(),Utils.exists(document.body)&&!document.body.hasAttribute("ytg-plus")&&document.body.setAttribute("ytg-plus",""))},k=()=>{void 0!==C&&C.disconnect(),Utils.exists(document.body)&&document.body.hasAttribute("ytg-plus")&&document.body.removeAttribute("ytg-plus")},E=()=>{const t=document.head||document.documentElement;Utils.exists(t)&&(Utils.exists(t.querySelector("link#ytg-plus"))||t.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css"  id="ytg-plus" href="'+chrome.runtime.getURL("styles/ytg-plus.min.css")+'">'))},L=()=>{var t,e,i;document.addEventListener("visibilitychange",A),a.theatreMode&&(T(),t=document.querySelector("ytd-video-primary-info-renderer h1 > yt-formatted-string"),e=document.querySelector("ytd-video-view-count-renderer > .view-count"),i=document.querySelector("ytd-rich-metadata-renderer #title"),Utils.exists(t)&&(v(),w.observe(t,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),Utils.exists(e)&&(g(),U.observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),Utils.exists(i)&&(f(),O.observe(i,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),i=document.querySelector("yt-live-chat-app"),Utils.exists(i)&&(S(i),q.observe(i,{attributes:!0})),x()),window.dispatchEvent(new Event("resize")),b()&&(s=!1,M(),k())},V=()=>{if(h()&&(t=document.querySelector(".html5-video-player > .ytp-chrome-top > .ytp-chrome-top-buttons > button.ytp-cards-button"),!Utils.exists(t)||"none"===t.style.display)&&s){if(o)L();else{if(b())return s=!1,M(),k(),!1;Storage.getSync(r,JSON.stringify(a)).then(t=>{o=!0,a={...a,...t}}).catch(t=>{}).finally(()=>L())}return void 0!==C&&C.disconnect(),setTimeout(()=>{const t=document.getElementsByClassName("ytp-play-button ytp-button")[0];if(Utils.exists(t)&&-1!==t.title.indexOf("Play"))t.click();else{const e=document.getElementsByClassName("ytp-live-badge ytp-button")[0];Utils.exists(e)&&(e.hasAttribute("disabled")||e.click())}},500),!0}return!1;var t},C=new MutationObserver(t=>{t.some(()=>{if(h())return C.disconnect(),V()})}),M=()=>{void 0!==C&&C.disconnect(),void 0!==w&&w.disconnect(),void 0!==U&&U.disconnect(),void 0!==O&&O.disconnect(),void 0!==q&&q.disconnect()},N=()=>{Utils.canRun(t,document.location.href)&&(s=!1,M(),E(),setTimeout(()=>{(()=>{if(!m())return s=!1,M();s=!0,n="visible"===document.visibilityState,E(),V()||C.observe(document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),setTimeout(()=>{h()||(s=!1,M(),k())},3e3)})()},500))};window.onload=N,window.addEventListener("yt-navigate-start",N,!0),chrome.runtime.onMessage.addListener((t,e,i)=>{if(m()&&t.type&&"youtubegaming+"===t.type&&t.system)if("background"===t.system)t.action&&"urlChange"===t.action?(k(),N()):t.action&&"initialLoad"===t.action?(o=!1,t.data.visualSettings&&(a={...a,...JSON.parse(JSON.stringify(t.data.visualSettings))}),k(),N()):t.action&&"extensionUpdate"===t.action||t.action&&t.action;else if("settings"===t.system){if(t.method&&"getSync"===t.method){const s=JSON.stringify(t.data)??JSON.stringify({});return Storage.getSync(t.key??"",s).then(t=>(i({success:!0,data:t}),!0)).catch(t=>(i({success:!1,data:s}),!0))}if(t.method&&"setSync"===t.method){const n=t.data??JSON.stringify({});return Storage.setSync(t.key??"",n).then(()=>(i({success:!0,data:n}),!0)).catch(t=>(i({success:!1,data:n}),!0))}}}),chrome.storage.onChanged.addListener((t,e)=>{for(var[i,{oldValue:s,newValue:n}]of Object.entries(t))if(i===r){if(o=!1,!m())return;a={...a,...n},k(),N()}})}();