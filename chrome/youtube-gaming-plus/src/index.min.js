!function(){const t=/https:\/\/www\.youtube\.com/i,e=/https:\/\/www\.youtube\.com\/watch\?v=/i,i=/https:\/\/www\.youtube\.com\/*(.+)\/live/i,n="youTubeGamingPlus.visualSettings";let r=!1,s=!1,o=!1,a={chat:{nameColor:!0,icon:!0,showDeleted:!1,simulatedDelay:!1,separatedLines:!0,bttvEmotes:!0,ffzEmotes:!0},theatreMode:!0,showReplayChat:!0,qualityOptimization:!1},c,l="",d,u=-1,y=void 0;const m=()=>Utils.canRun(e,document.location.href)||Utils.canRun(i,document.location.href),h=()=>{const t=document.querySelector("ytd-live-chat-frame");return Utils.exists(t)&&!t.hasAttribute("hidden")};const p=()=>{var t=document.querySelector("ytd-channel-name > #container > #text-container > yt-formatted-string > a");return Utils.exists(t)?t.innerText:""},b=()=>{const e=p().toLowerCase();var t=supportedChannels.find(t=>t.youtube.name===e);return Utils.exists(t)&&!t.youtube.enable},v=()=>{const t=document.querySelector(".ytg-title");if(h()){var e=document.querySelector("ytd-video-primary-info-renderer h1 > yt-formatted-string");const i=document.querySelector(".html5-video-player .html5-video-container");c=e.innerText,Utils.exists(i)&&(Utils.exists(t)?t.innerText=""+c:i.insertBefore(((t="")=>{const e=document.createElement("template");return e.innerHTML=`<div class="ytg-top-bar"><h1 class="title style-scope ytd-video-primary-info-renderer ytg-title">${t} <span class='style-scope ytd-video-view-count-renderer ytg-title-views'></span></h1></div>`,e.innerText=t,e.content})(c),i.childNodes[0]))}else Utils.exists(t)&&t.remove()},g=()=>{if(h()){const e=document.querySelector("ytd-video-view-count-renderer > .view-count");if(Utils.exists(e)){var t=""===l?" ":` ${l} `;const i=document.querySelector(".ytg-title-views");d=e.innerText.split(" ")[0],Utils.exists(i)&&(""===d?i.innerText="Streaming"+t:i.innerText=`Streaming${t}for ${d} viewers`)}}},f=()=>{var t;h()&&(t=document.querySelector("ytd-rich-metadata-renderer #title"),l=Utils.exists(t)?t.innerText:"")},S=()=>{const t=document.querySelector("video.video-stream.html5-main-video");Utils.exists(t)&&(t.style.setProperty("width",t.parentElement.scrollWidth+"px"),t.style.setProperty("height",t.parentElement.scrollHeight+"px"),t.style.setProperty("left","0px"),t.style.setProperty("top","0px"))},x=t=>{Utils.exists(t)&&Utils.exists(document.body)&&(t.hasAttribute("collapsed")?document.body.hasAttribute("ytg-hide-chat")||document.body.setAttribute("ytg-hide-chat",""):document.body.hasAttribute("ytg-hide-chat")&&document.body.removeAttribute("ytg-hide-chat"),window.dispatchEvent(new CustomEvent("updateChatCollapsed",{detail:{collapsed:!0},bubbles:!0})))},w=new MutationObserver((t,e)=>{v()}),U=new MutationObserver((t,e)=>{g()}),q=new MutationObserver((t,e)=>{f()}),O=new MutationObserver(t=>{for(const i of t){var e;"attributes"===i.type&&(e=i.target,Utils.exists(e)&&s&&x(i.target))}}),A=()=>{if(s&&(o="visible"===document.visibilityState,a.qualityOptimization)){if("visible"===document.visibilityState&&y)return y.click(),u=-1,void(y=void 0);const i=document.querySelector("#player-container .ytp-chrome-bottom button.ytp-button.ytp-settings-button");if(Utils.exists(i)){i.click();const t=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem")).at(-1);Utils.exists(t)&&(t.click(),"visible"===document.visibilityState?setTimeout(()=>{const t=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem")),e=t.at(u);(Utils.exists(e)?e:i).click()},500):setTimeout(()=>{const e=Array.from(document.querySelectorAll(".ytp-settings-menu > .ytp-panel > .ytp-panel-menu > .ytp-menuitem"));for(let t=0;t<e.length-1;t++){var i=e.at(t);(i.ariaChecked||i.ariaSelected)&&(u=t,y=i)}const t=e.at(-2);Utils.exists(t)&&t.click()},200))}}},T=()=>{m()&&(void 0!==V&&V.disconnect(),Utils.exists(document.body)&&!document.body.hasAttribute("ytg-plus")&&(document.body.setAttribute("ytg-plus",""),console.log("[YouTubeGaming+] Added: page attribute!")))},k=()=>{void 0!==V&&V.disconnect(),Utils.exists(document.body)&&document.body.hasAttribute("ytg-plus")&&(document.body.removeAttribute("ytg-plus"),console.log("[YouTubeGaming+] Removed: page attribute!"))},E=()=>{const t=document.head||document.documentElement;Utils.exists(t)&&(Utils.exists(t.querySelector("link#ytg-plus"))||(t.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css"  id="ytg-plus" href="'+chrome.runtime.getURL("styles/ytg-plus.min.css")+'">'),console.log("[YouTubeGaming+] Loaded: styles!")))},L=()=>{var t,e,i;document.addEventListener("visibilitychange",A),a.theatreMode&&(T(),t=document.querySelector("ytd-video-primary-info-renderer h1 > yt-formatted-string"),e=document.querySelector("ytd-video-view-count-renderer > .view-count"),i=document.querySelector("ytd-rich-metadata-renderer #title"),Utils.exists(t)&&(v(),w.observe(t,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),Utils.exists(e)&&(g(),U.observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),Utils.exists(i)&&(f(),q.observe(i,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})),i=document.querySelector("yt-live-chat-app"),Utils.exists(i)&&(x(i),O.observe(i,{attributes:!0})),S()),window.dispatchEvent(new Event("resize")),b()&&(s=!1,D(),k())},C=()=>{if(h()&&(t=document.querySelector(".html5-video-player > .ytp-chrome-top > .ytp-chrome-top-buttons > button.ytp-cards-button"),!Utils.exists(t)||"none"===t.style.display)&&s){if(r)L();else{if(b())return s=!1,D(),k(),!1;Storage.getSync(n,JSON.stringify(a)).then(t=>{r=!0,a={...a,...t}}).catch(t=>{console.error("Storage.getSync",n,t)}).finally(()=>L())}return void 0!==V&&V.disconnect(),setTimeout(()=>{const t=document.getElementsByClassName("ytp-play-button ytp-button")[0];if(Utils.exists(t)&&-1!==t.title.indexOf("Play"))t.click();else{const e=document.getElementsByClassName("ytp-live-badge ytp-button")[0];Utils.exists(e)&&(e.hasAttribute("disabled")||e.click())}},500),!0}return!1;var t},V=new MutationObserver(t=>{t.some(()=>{if(h())return V.disconnect(),C()})}),D=()=>{void 0!==V&&V.disconnect(),void 0!==w&&w.disconnect(),void 0!==U&&U.disconnect(),void 0!==q&&q.disconnect(),void 0!==O&&O.disconnect()},M=()=>{Utils.canRun(t,document.location.href)&&(s=!1,D(),E(),setTimeout(()=>{(()=>{if(!m())return s=!1,D();s=!0,o="visible"===document.visibilityState,E(),C()||V.observe(document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),setTimeout(()=>{h()||(s=!1,D(),k())},3e3)})()},500))};window.onload=M,window.addEventListener("yt-navigate-start",M,!0),chrome.runtime.onMessage.addListener((e,t,i)=>{if(m()&&e.type&&"youtubegaming+"===e.type&&e.system)if("background"===e.system)e.action&&"urlChange"===e.action?(k(),M()):e.action&&"initialLoad"===e.action?(r=!1,e.data.visualSettings&&(a={...a,...JSON.parse(JSON.stringify(e.data.visualSettings))}),k(),M()):e.action&&"extensionUpdate"===e.action?(console.log(e.data),console.log(e.data.previousVersion),console.log(e.data.currentVersion)):e.action&&"unknown"===e.action&&(console.log(e),console.log(e.data));else if("settings"===e.system){if(e.method&&"getSync"===e.method){const s=JSON.stringify(e.data)??JSON.stringify({});return Storage.getSync(e.key??"",s).then(t=>(i({success:!0,data:t}),!0)).catch(t=>(console.error("request.getSync",e.key,t),i({success:!1,data:s}),!0))}if(e.method&&"setSync"===e.method){const o=e.data??JSON.stringify({});return Storage.setSync(e.key??"",o).then(()=>(i({success:!0,data:o}),!0)).catch(t=>(console.error("request.setSync",e.key,t),i({success:!1,data:o}),!0))}}}),chrome.storage.onChanged.addListener((t,e)=>{for(var[i,{oldValue:s,newValue:o}]of Object.entries(t))if(i===n){if(r=!1,!m())return;console.log("chrome.storage.onChanged"),console.log(s),console.log(o),a={...a,...o},k(),M()}})}();