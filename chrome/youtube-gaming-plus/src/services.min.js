!function(){"use strict";var c=window.Document.prototype.createElement,l=window.Document.prototype.createElementNS,d=window.Document.prototype.importNode,u=window.Document.prototype.prepend,h=window.Document.prototype.append,p=window.DocumentFragment.prototype.prepend,f=window.DocumentFragment.prototype.append,m=window.Node.prototype.cloneNode,y=window.Node.prototype.appendChild,g=window.Node.prototype.insertBefore,v=window.Node.prototype.removeChild,b=window.Node.prototype.replaceChild,w=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),E=window.Element.prototype.attachShadow,C=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),_=window.Element.prototype.getAttribute,T=window.Element.prototype.setAttribute,j=window.Element.prototype.removeAttribute,S=window.Element.prototype.getAttributeNS,x=window.Element.prototype.setAttributeNS,N=window.Element.prototype.removeAttributeNS,k=window.Element.prototype.insertAdjacentElement,A=window.Element.prototype.insertAdjacentHTML,D=window.Element.prototype.prepend,L=window.Element.prototype.append,O=window.Element.prototype.before,F=window.Element.prototype.after,M=window.Element.prototype.replaceWith,U=window.Element.prototype.remove,P=window.HTMLElement,q=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),z=window.HTMLElement.prototype.insertAdjacentElement,$=window.HTMLElement.prototype.insertAdjacentHTML,o=new Set;function r(t){var e=o.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!e&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach(function(t){return o.add(t)});var n=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function B(t){var e=t.isConnected;if(void 0!==e)return e;if(n(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function H(t){var e=t.children;if(e)return Array.prototype.slice.call(e);for(e=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&e.push(t);return e}function a(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function I(){var t=!(null==at||!at.noDocumentConstructionObserver),e=!(null==at||!at.shadyDomFastWalk);this.m=[],this.g=[],this.j=!1,this.shadyDomFastWalk=e,this.I=!t}function R(t,e,o,r){var n=window.ShadyDOM;if(t.shadyDomFastWalk&&n&&n.inUse){if(e.nodeType===Node.ELEMENT_NODE&&o(e),e.querySelectorAll)for(t=n.nativeMethods.querySelectorAll.call(e,"*"),e=0;e<t.length;e++)o(t[e])}else!function t(e,o,r){for(var n=e;n;){if(n.nodeType===Node.ELEMENT_NODE){var i=n;o(i);var s=i.localName;if("link"===s&&"import"===i.getAttribute("rel")){if(n=i.import,void 0===r&&(r=new Set),n instanceof Node&&!r.has(n))for(r.add(n),n=n.firstChild;n;n=n.nextSibling)t(n,o,r);n=a(e,i);continue}if("template"===s){n=a(e,i);continue}if(i=i.__CE_shadowRoot)for(i=i.firstChild;i;i=i.nextSibling)t(i,o,r)}n=n.firstChild||a(e,n)}}(e,o,r)}function V(e,t){e.j&&R(e,t,function(t){return W(e,t)})}function W(t,e){if(t.j&&!e.__CE_patched){e.__CE_patched=!0;for(var o=0;o<t.m.length;o++)t.m[o](e);for(o=0;o<t.g.length;o++)t.g[o](e)}}function Z(t,e){var o=[];for(R(t,e,function(t){return o.push(t)}),e=0;e<o.length;e++){var r=o[e];1===r.__CE_state?t.connectedCallback(r):Y(t,r)}}function G(t,e){var o=[];for(R(t,e,function(t){return o.push(t)}),e=0;e<o.length;e++){var r=o[e];1===r.__CE_state&&t.disconnectedCallback(r)}}function J(r,t,e){var n=(e=void 0===e?{}:e).J,i=e.upgrade||function(t){return Y(r,t)},s=[];for(R(r,t,function(o){var t;r.j&&W(r,o),"link"===o.localName&&"import"===o.getAttribute("rel")?((t=o.import)instanceof Node&&(t.__CE_isImportDocument=!0,t.__CE_registry=document.__CE_registry),t&&"complete"===t.readyState?t.__CE_documentLoadHandled=!0:o.addEventListener("load",function(){var e,t=o.import;t.__CE_documentLoadHandled||(t.__CE_documentLoadHandled=!0,e=new Set,n&&(n.forEach(function(t){return e.add(t)}),e.delete(t)),J(r,t,{J:e,upgrade:i}))})):s.push(o)},n),t=0;t<s.length;t++)i(s[t])}function Y(t,e){try{var o=e.ownerDocument,r=o.__CE_registry;if((i=r&&(o.defaultView||o.__CE_isImportDocument)?rt(r,e.localName):void 0)&&void 0===e.__CE_state){i.constructionStack.push(e);try{try{if(new i.constructorFunction!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{i.constructionStack.pop()}}catch(t){throw e.__CE_state=2,t}if(e.__CE_state=1,(e.__CE_definition=i).attributeChangedCallback&&e.hasAttributes())for(var n=i.observedAttributes,i=0;i<n.length;i++){var s=n[i],a=e.getAttribute(s);null!==a&&t.attributeChangedCallback(e,s,null,a,null)}B(e)&&t.connectedCallback(e)}}catch(t){X(t)}}function K(e,o,r,n){var t=o.__CE_registry;if(t&&(null===n||"http://www.w3.org/1999/xhtml"===n)&&(t=rt(t,r)))try{var i=new t.constructorFunction;if(void 0===i.__CE_state||void 0===i.__CE_definition)throw Error("Failed to construct '"+r+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==i.namespaceURI)throw Error("Failed to construct '"+r+"': The constructed element's namespace must be the HTML namespace.");if(i.hasAttributes())throw Error("Failed to construct '"+r+"': The constructed element must not have any attributes.");if(null!==i.firstChild)throw Error("Failed to construct '"+r+"': The constructed element must not have any children.");if(null!==i.parentNode)throw Error("Failed to construct '"+r+"': The constructed element must not have a parent node.");if(i.ownerDocument!==o)throw Error("Failed to construct '"+r+"': The constructed element's owner document is incorrect.");if(i.localName!==r)throw Error("Failed to construct '"+r+"': The constructed element's local name is incorrect.");return i}catch(t){return X(t),o=null===n?c.call(o,r):l.call(o,n,r),Object.setPrototypeOf(o,HTMLUnknownElement.prototype),o.__CE_state=2,o.__CE_definition=void 0,W(e,o),o}return W(e,o=null===n?c.call(o,r):l.call(o,n,r)),o}function X(t){var e=t.message,o=t.sourceURL||t.fileName||"",r=t.line||t.lineNumber||0,n=t.column||t.columnNumber||0,i=void 0;void 0===ErrorEvent.prototype.initErrorEvent?i=new ErrorEvent("error",{cancelable:!0,message:e,filename:o,lineno:r,colno:n,error:t}):((i=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,e,o,r),i.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===i.error&&Object.defineProperty(i,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(i),i.defaultPrevented||console.error(t)}function i(){var e=this;this.g=void 0,this.F=new Promise(function(t){e.l=t})}function e(t){var e=document;this.l=void 0,this.h=t,this.g=e,J(this.h,this.g),"loading"===this.g.readyState&&(this.l=new MutationObserver(this.G.bind(this)),this.l.observe(this.g,{childList:!0,subtree:!0}))}function s(t){t.l&&t.l.disconnect()}function Q(t){this.s=new Map,this.u=new Map,this.C=new Map,this.A=!1,this.B=new Map,this.o=function(t){return t()},this.i=!1,this.v=[],this.h=t,this.D=t.I?new e(t):void 0}function tt(t,e){if(!r(e))throw new SyntaxError("The element name '"+e+"' is not valid.");if(rt(t,e))throw Error("A custom element with name '"+e+"' has already been defined.");if(t.A)throw Error("A custom element is already being defined.")}function et(t,e,o){var r;t.A=!0;try{var n=o.prototype;if(!(n instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var i=function(t){var e=n[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},s=i("connectedCallback"),a=i("disconnectedCallback"),c=i("adoptedCallback"),l=(r=i("attributeChangedCallback"))&&o.observedAttributes||[]}catch(t){throw t}finally{t.A=!1}return t.u.set(e,o={localName:e,constructorFunction:o,connectedCallback:s,disconnectedCallback:a,adoptedCallback:c,attributeChangedCallback:r,observedAttributes:l,constructionStack:[]}),t.C.set(o.constructorFunction,o),o}function ot(r){if(!1!==r.i){r.i=!1;for(var n=[],t=r.v,i=new Map,e=0;e<t.length;e++)i.set(t[e],[]);for(J(r.h,document,{upgrade:function(t){var e,o;void 0===t.__CE_state&&(e=t.localName,(o=i.get(e))?o.push(t):r.u.has(e)&&n.push(t))}}),e=0;e<n.length;e++)Y(r.h,n[e]);for(e=0;e<t.length;e++){for(var o=t[e],s=i.get(o),a=0;a<s.length;a++)Y(r.h,s[a]);(o=r.B.get(o))&&o.resolve(void 0)}t.length=0}}function rt(t,e){var o=t.u.get(e);if(o)return o;if(o=t.s.get(e)){t.s.delete(e);try{return et(t,e,o())}catch(t){X(t)}}}function nt(a,t,e){function o(s){return function(t){for(var e=[],o=0;o<arguments.length;++o)e[o]=arguments[o];for(var o=[],r=[],n=0;n<e.length;n++){var i=e[n];if(i instanceof Element&&B(i)&&r.push(i),i instanceof DocumentFragment)for(i=i.firstChild;i;i=i.nextSibling)o.push(i);else o.push(i)}for(s.apply(this,e),e=0;e<r.length;e++)G(a,r[e]);if(B(this))for(e=0;e<o.length;e++)(r=o[e])instanceof Element&&Z(a,r)}}void 0!==e.prepend&&(t.prepend=o(e.prepend)),void 0!==e.append&&(t.append=o(e.append))}function it(s){function e(t,i){Object.defineProperty(t,"innerHTML",{enumerable:i.enumerable,configurable:!0,get:i.get,set:function(t){var e=this,o=void 0;if(B(this)&&(o=[],R(s,this,function(t){t!==e&&o.push(t)})),i.set.call(this,t),o)for(var r=0;r<o.length;r++){var n=o[r];1===n.__CE_state&&s.disconnectedCallback(n)}return(this.ownerDocument.__CE_registry?J:V)(s,this),t}})}function t(t,r){t.insertAdjacentElement=function(t,e){var o=B(e);return t=r.call(this,t,e),o&&G(s,e),B(t)&&Z(s,e),t}}function o(t,r){function n(t,e){for(var o=[];t!==e;t=t.nextSibling)o.push(t);for(e=0;e<o.length;e++)J(s,o[e])}t.insertAdjacentHTML=function(t,e){if("beforebegin"===(t=t.toLowerCase())){var o=this.previousSibling;r.call(this,t,e),n(o||this.parentNode.firstChild,this)}else if("afterbegin"===t)o=this.firstChild,r.call(this,t,e),n(this.firstChild,o);else if("beforeend"===t)o=this.lastChild,r.call(this,t,e),n(o||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");o=this.nextSibling,r.call(this,t,e),n(this.nextSibling,o)}}}var r,a,n;function i(s){return function(t){for(var e=[],o=0;o<arguments.length;++o)e[o]=arguments[o];for(var o=[],r=[],n=0;n<e.length;n++){var i=e[n];if(i instanceof Element&&B(i)&&r.push(i),i instanceof DocumentFragment)for(i=i.firstChild;i;i=i.nextSibling)o.push(i);else o.push(i)}for(s.apply(this,e),e=0;e<r.length;e++)G(a,r[e]);if(B(this))for(e=0;e<o.length;e++)(r=o[e])instanceof Element&&Z(a,r)}}E&&(Element.prototype.attachShadow=function(t){if(t=E.call(this,t),s.j&&!t.__CE_patched){t.__CE_patched=!0;for(var e=0;e<s.m.length;e++)s.m[e](t)}return this.__CE_shadowRoot=t}),C&&C.get?e(Element.prototype,C):q&&q.get?e(HTMLElement.prototype,q):(n=function(t){e(t,{enumerable:!0,configurable:!0,get:function(){return m.call(this,!0).innerHTML},set:function(t){var e="template"===this.localName,o=e?this.content:this,r=l.call(document,this.namespaceURI,this.localName);for(r.innerHTML=t;0<o.childNodes.length;)v.call(o,o.childNodes[0]);for(t=e?r.content:r;0<t.childNodes.length;)y.call(o,t.childNodes[0])}})},(r=s).j=!0,r.g.push(n)),Element.prototype.setAttribute=function(t,e){if(1!==this.__CE_state)return T.call(this,t,e);var o=_.call(this,t);T.call(this,t,e),e=_.call(this,t),s.attributeChangedCallback(this,t,o,e,null)},Element.prototype.setAttributeNS=function(t,e,o){if(1!==this.__CE_state)return x.call(this,t,e,o);var r=S.call(this,t,e);x.call(this,t,e,o),o=S.call(this,t,e),s.attributeChangedCallback(this,e,r,o,t)},Element.prototype.removeAttribute=function(t){if(1!==this.__CE_state)return j.call(this,t);var e=_.call(this,t);j.call(this,t),null!==e&&s.attributeChangedCallback(this,t,e,null,null)},Element.prototype.removeAttributeNS=function(t,e){if(1!==this.__CE_state)return N.call(this,t,e);var o=S.call(this,t,e);N.call(this,t,e);var r=S.call(this,t,e);o!==r&&s.attributeChangedCallback(this,e,o,r,t)},z?t(HTMLElement.prototype,z):k&&t(Element.prototype,k),$?o(HTMLElement.prototype,$):A&&o(Element.prototype,A),nt(s,Element.prototype,{prepend:D,append:L}),a=s,n=Element.prototype,void 0!==O&&(n.before=i(O)),void 0!==F&&(n.after=i(F)),void 0!==M&&(n.replaceWith=function(t){for(var e=[],o=0;o<arguments.length;++o)e[o]=arguments[o];for(var o=[],r=[],n=0;n<e.length;n++){var i=e[n];if(i instanceof Element&&B(i)&&r.push(i),i instanceof DocumentFragment)for(i=i.firstChild;i;i=i.nextSibling)o.push(i);else o.push(i)}for(n=B(this),M.apply(this,e),e=0;e<r.length;e++)G(a,r[e]);if(n)for(G(a,this),e=0;e<o.length;e++)(r=o[e])instanceof Element&&Z(a,r)}),void 0!==U&&(n.remove=function(){var t=B(this);U.call(this),t&&G(a,this)})}I.prototype.connectedCallback=function(t){var e=t.__CE_definition;if(e.connectedCallback)try{e.connectedCallback.call(t)}catch(t){X(t)}},I.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;if(e.disconnectedCallback)try{e.disconnectedCallback.call(t)}catch(t){X(t)}},I.prototype.attributeChangedCallback=function(t,e,o,r,n){var i=t.__CE_definition;if(i.attributeChangedCallback&&-1<i.observedAttributes.indexOf(e))try{i.attributeChangedCallback.call(t,e,o,r,n)}catch(t){X(t)}},i.prototype.resolve=function(t){if(this.g)throw Error("Already resolved.");this.g=t,this.l(t)},e.prototype.G=function(t){var e=this.g.readyState;for("interactive"!==e&&"complete"!==e||s(this),e=0;e<t.length;e++)for(var o=t[e].addedNodes,r=0;r<o.length;r++)J(this.h,o[r])},Q.prototype.H=function(t,e){var o=this;if(!(e instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");tt(this,t),this.s.set(t,e),this.v.push(t),this.i||(this.i=!0,this.o(function(){return ot(o)}))},Q.prototype.define=function(t,e){var o=this;if(!(e instanceof Function))throw new TypeError("Custom element constructors must be functions.");tt(this,t),et(this,t,e),this.v.push(t),this.i||(this.i=!0,this.o(function(){return ot(o)}))},Q.prototype.upgrade=function(t){J(this.h,t)},Q.prototype.get=function(t){if(t=rt(this,t))return t.constructorFunction},Q.prototype.whenDefined=function(t){if(!r(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var e=this.B.get(t);if(e)return e.F;e=new i,this.B.set(t,e);var o=this.u.has(t)||this.s.has(t);return t=-1===this.v.indexOf(t),o&&t&&e.resolve(void 0),e.F},Q.prototype.polyfillWrapFlushCallback=function(e){this.D&&s(this.D);var o=this.o;this.o=function(t){return e(function(){return o(t)})}},(window.CustomElementRegistry=Q).prototype.polyfillDefineLazy=Q.prototype.H;var st={};var at=window.customElements;function t(){var i,o,s,t,e,r=new I;function n(){var t=this.constructor,e=document.__CE_registry.C.get(t);if(!e)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var o=e.constructionStack;if(0===o.length)return o=c.call(document,e.localName),Object.setPrototypeOf(o,t.prototype),o.__CE_state=1,o.__CE_definition=e,W(i,o),o;var r=o.length-1,n=o[r];if(n===st)throw Error("Failed to construct '"+e.localName+"': This element was already constructed.");return o[r]=st,Object.setPrototypeOf(n,t.prototype),W(i,n),n}function a(t,i){Object.defineProperty(t,"textContent",{enumerable:i.enumerable,configurable:!0,get:i.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)i.set.call(this,t);else{var e=void 0;if(this.firstChild){var o=this.childNodes,r=o.length;if(0<r&&B(this))for(var e=Array(r),n=0;n<r;n++)e[n]=o[n]}if(i.set.call(this,t),e)for(t=0;t<e.length;t++)G(s,e[t])}}})}i=r,n.prototype=P.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:n}),window.HTMLElement=n,o=r,Document.prototype.createElement=function(t){return K(o,this,t,null)},Document.prototype.importNode=function(t,e){return t=d.call(this,t,!!e),(this.__CE_registry?J:V)(o,t),t},Document.prototype.createElementNS=function(t,e){return K(o,this,e,t)},nt(o,Document.prototype,{prepend:u,append:h}),nt(r,DocumentFragment.prototype,{prepend:p,append:f}),s=r,Node.prototype.insertBefore=function(t,e){if(t instanceof DocumentFragment){var o=H(t);if(t=g.call(this,t,e),B(this))for(e=0;e<o.length;e++)Z(s,o[e]);return t}return o=t instanceof Element&&B(t),e=g.call(this,t,e),o&&G(s,t),B(this)&&Z(s,t),e},Node.prototype.appendChild=function(t){if(t instanceof DocumentFragment){var e=H(t);if(t=y.call(this,t),B(this))for(var o=0;o<e.length;o++)Z(s,e[o]);return t}return e=t instanceof Element&&B(t),o=y.call(this,t),e&&G(s,t),B(this)&&Z(s,t),o},Node.prototype.cloneNode=function(t){return t=m.call(this,!!t),(this.ownerDocument.__CE_registry?J:V)(s,t),t},Node.prototype.removeChild=function(t){var e=t instanceof Element&&B(t),o=v.call(this,t);return e&&G(s,t),o},Node.prototype.replaceChild=function(t,e){if(t instanceof DocumentFragment){var o=H(t);if(t=b.call(this,t,e),B(this))for(G(s,e),e=0;e<o.length;e++)Z(s,o[e]);return t}var o=t instanceof Element&&B(t),r=b.call(this,t,e),n=B(this);return n&&G(s,e),o&&G(s,t),n&&Z(s,t),r},w&&w.get?a(Node.prototype,w):(e=function(t){a(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=this.firstChild;e;e=e.nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.textContent);return t.join("")},set:function(t){for(;this.firstChild;)v.call(this,this.firstChild);null!=t&&""!==t&&y.call(this,document.createTextNode(t))}})},(t=s).j=!0,t.m.push(e)),it(r),r=new Q(r),document.__CE_registry=r,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:r})}at&&!at.forcePolyfill&&"function"==typeof at.define&&"function"==typeof at.get||t(),window.__CE_installPolyfill=t}.call(self);const visualSettingsKey="youTubeGamingPlus.visualSettings",chatUsersKey="youTubeGamingPlus.chatters",defaultVisualSettings={chat:{nameColor:!0,icon:!0,showDeleted:!1,simulatedDelay:!1,separatedLines:!0,bttvEmotes:!0,ffzEmotes:!0},theatreMode:!0,showReplayChat:!0,qualityOptimization:!1},defaultChatElements={target:document.createElement("div"),app:void 0,innerBody:void 0,dropdown:void 0,modes:void 0,inputRenderer:void 0,textInputFieldRenderer:void 0,inputField:void 0,ironDropdown:void 0,dropdownContent:void 0},supportedChannels=[{youtube:{name:"blurrypenguin",enable:!0},twitch:{name:"blurrypenguin",id:134609363}},{youtube:{name:"valkyrae",enable:!0},twitch:{name:"valkyrae",id:79615025}},{youtube:{name:"courage",enable:!0},twitch:{name:"couragejd",id:106125347}},{youtube:{name:"timthetatman",enable:!0},twitch:{name:"timthetatman",id:36769016}},{youtube:{name:"drlupo",enable:!0},twitch:{name:"drlupo",id:29829912}},{youtube:{name:"ludwig",enable:!1},twitch:{name:"ludwig",id:40934651}}],defaultEmoji={emojiId:"ytg-0674b390-c5e2-464a-bc48-8ff6c70a03d6",image:{accessibility:{accessibilityData:{label:"yt"}},thumbnails:[{height:24,url:"",width:24},{height:48,url:"",width:48}]},isCustomEmoji:!0,searchTerms:[""],shortcuts:["::"]},defaultElement=document.createElement("empty");class Chrome{static getProto=t=>t.constructor.prototype||Object.getPrototypeOf(t);static getMethods=e=>{let o=new Set,t=e;for(;Object.getOwnPropertyNames(t).map(t=>o.add(t)),t=Object.getPrototypeOf(t););return[...o.keys()].filter(t=>"function"==typeof e[t])};static getProps=t=>{let e=[];for(;null!=t;t=Object.getPrototypeOf(t)){var o=Object.getOwnPropertyNames(t);for(let t=0;t<o.length;t++)-1==e.indexOf(o[t])&&e.push(o[t])}return e};static getFunctions=t=>{t=t.constructor.prototype;return Object.getOwnPropertyNames(t).filter(t=>"function"==typeof String.prototype[t])}}class Utils{static isNumber=t=>"number"==typeof t&&isFinite(t);static isBoolean=t=>"boolean"==typeof val;static canRun=(t,e)=>!!t.test(e);static uuid=()=>crypto.randomUUID();static uuid4=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));static exists=t=>null!=t;static invalidElement=t=>!this.exists(t)||""===t.tagName||"empty"===t.tagName;static generatePastelColor=()=>{let t=(Math.floor(127*Math.random()+127)<<16)+(Math.floor(127*Math.random()+127)<<8)+Math.floor(127*Math.random()+127);return"#"+t.toString(16)};static getDocument=t=>t.contentDocument||t.contentWindow.document;static zt=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?function(t){return ShadyDOM.patch(t)}:function(t){return t};static fire=(t,e,o)=>{o=o||{},e=null==e?{}:e;const r=new Event(t,{bubbles:void 0===o.bubbles||o.bubbles,cancelable:!!o.cancelable,composed:void 0===o.composed||o.composed});return r.detail=e,window.dispatchEvent(r),r};static getMethods=e=>{let o=new Set,t=e;for(;Object.getOwnPropertyNames(t).map(t=>o.add(t)),t=Object.getPrototypeOf(t););return[...o.keys()].filter(t=>"function"==typeof e[t])};static randomInt=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;static splitMessage=t=>{return t.split(/\s*(<[^>]*>)|[\s.,?!\/]/gim).filter(Boolean)};static emoteToImage=({provider:t,src:e,code:o,id:r})=>`<img class="emoji ${t} yt-formatted-string style-scope yt-live-chat-text-message-renderer" src="${e}" alt="${o}" title="${o}" shared-tooltip-text="${o}" id="emoji-${t}-${r}" />`;static insertImages=(t,e)=>Object.entries({[e.code]:e}).reduce((t,[,{provider:e,src:o,code:r,id:n}])=>t.replace(new RegExp(`[s+]?${r}[s+]?`),`<img class="emoji ${e} yt-formatted-string style-scope yt-live-chat-text-message-renderer" src="${o}" alt="${r}" title="${r}" shared-tooltip-text="${r}" id="emoji-${e}-${n}" />`),t);static fetchJSON=async(t,e={node:"cors"})=>{try{const o=await(t=>{if(!t.ok)throw Error(t.statusText);return t})(await fetch(t,e));return o.json()}catch(t){throw Error(t)}};static camelCaseToDashed=t=>t.replace(/[A-Z]/g,t=>"-"+t.toLowerCase());static dashToCamelCase=t=>t.split("-").reduce((t,e)=>t+e.charAt(0).toUpperCase()+e.slice(1));static dataToKey=t=>{const e=this.dashToCamelCase(t).replace("data-","");return e.charAt(0).toLowerCase()+e.slice(1)};static setAttributes=(e,o)=>Object.keys(o).forEach(t=>e.setAttribute(t,o[t]));static setDataAttributes=(e,o={})=>Object.keys(o).forEach(t=>e.setAttribute("data-"+this.camelCaseToDashed(t),o[t]));static getDataAttributes=t=>{let e={};var o=t.dataset;for(const n in o){var r=o[n];this.isBoolean(r)?e[n]=Boolean(r):this.isNumber(r)?e[n]=Number(r):e[n]=r}return e};static sendMessage=async r=>new Promise((e,o)=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{chrome.tabs.sendMessage(t[0].id,{type:"youtubegaming+",system:"ytg+",tabId:t[0].id,...r},t=>chrome.runtime.lastError?o({success:!1,data:r,error:chrome.runtime.lastError.message}):e(t))})});static A={OverrideFunction:0,RunBefore:1,RunAfter:2};static C=(t,e,{locked:o})=>({functionName:t,function:e,locked:o||!1,type:this.A.RunBefore});static I=async(t,o)=>{console.log(customElements),await customElements.whenDefined(t);const e=customElements.get(t);if(console.log(e),e){const r=e.prototype[o.functionName];e.prototype[o.functionName]=function(...t){if(r.apply(this,t),o.type===Utils.A.OverrideFunction)try{return o.function.apply(this,t)}catch(t){console.error(JSON.stringify(o)),console.error(t)}if(o.type===Utils.A.RunBefore)try{o.function.apply(this,t)}catch(t){console.error(t)}let e=r.apply(this,t);if(o.type===Utils.A.RunAfter)try{e=o.function.apply(this,[e])}catch(t){console.error(t)}return e},console.log(e)}else console.warn(`Polymer: ${t} not found`)}}class Storage{static removeLocal=async(t="")=>{try{return await chrome.storage.local.remove(t),!0}catch{throw new Error(!1)}};static removeSync=async(t="")=>{try{return await chrome.storage.sync.remove(t),!0}catch{throw new Error(!1)}};static getLocalBytesInUse=async(t="")=>{try{var e=await chrome.storage.local.getBytesInUse(t);return Promise.resolve(e)}catch{throw new Error(!1)}};static getSyncBytesInUse=async(t="")=>{try{var e=await chrome.storage.sync.getBytesInUse(t);return Promise.resolve(e)}catch{throw new Error(!1)}};static getLocal=async(t="",e=null)=>{try{var o=await chrome.storage.local.get(t);return Promise.resolve(o[t]??e)}catch{throw new Error(e)}};static getSync=async(t="",e=null)=>{try{var o=await chrome.storage.sync.get(t);return Promise.resolve(o[t]??e)}catch{throw new Error(e)}};static setLocal=async(t="",e=null)=>{try{return await this.removeLocal(t),await chrome.storage.local.set({[t]:e}),Promise.resolve(!0)}catch{throw new Error(e)}};static setSync=async(t="",e=null)=>{try{return await this.removeSync(t),await chrome.storage.sync.set({[t]:e}),Promise.resolve(!0)}catch{throw new Error(e)}}}class Mutations{mutations=[];add(e,t,o,r={},n=!0){const i=this.mutations.find(t=>t.id===e),s=new MutationObserver((t,e)=>o(t,e));return i?(i.target=t,i.callback=o,i.options=r,i.o.disconnect(),i.o=s):(this.mutations.push({id:e,target:t,o:s,callback:o,options:r}),n&&s.observe(t,r)),s}observe(e){const t=this.mutations.find(t=>t.id===e);t&&t.o.observe(t.target,t.options)}disconnect(e){const t=this.mutations.find(t=>t.id===e);t&&t.o.disconnect()}flush(){for(const t of this.mutations)t&&t.o.disconnect();this.mutations=[]}}class Emotes{bttv=[];ffz=[];emojis=[];emoteCache=new Map;chatSettings={...defaultVisualSettings.chat};chatElements={...defaultChatElements};excludesWords=["name"];constructor(t={settings:defaultVisualSettings.chat}){this.chatSettings={...t.settings},this.emoteCache.clear()}get chatSettings(){return this.chatSettings}set chatSettings(t=defaultVisualSettings.chat){this.chatSettings=t}get bttv(){return this.bttv}get ffz(){return this.ffz}build=async()=>{const t=[];if(this.chatSettings.bttvEmotes)for(const e of this.bttv)e.id&&e.code&&t.push({provider:"bttv",id:e.id,code:e.code,src:`https://cdn.betterttv.net/emote/${e.id}/1x`});if(this.chatSettings.ffzEmotes)for(const o of this.ffz)o.id&&o.code&&o.images&&t.push({provider:"ffz",id:o.id,code:o.code,src:""+o.images["1x"]});return this.emojis=t,t};emoteData=t=>{let e=`https://cdn.betterttv.net/emote/${t.id}/1x`;"twitch"===t.provider?e=`https://static-cdn.jtvnw.net/emoticons/v2/${t.id}/static/dark/1.0`:"ffz"===t.provider&&(e=`https://cdn.frankerfacez.com/emote/${t.id}/1`);var o=t.code.replace(/:/g,"");return{emojiId:"ytg-"+o+"-"+t.id,image:{thumbnails:[{url:e}],accessibility:{accessibilityData:{label:o}}},isCustomEmoji:!0,searchTerms:[o],shortcuts:[":"+o+":",o]}};create=async(t={...defaultChatElements})=>{if(this.emojis.length<=0||0<this.emoteCache.size)return!1;this.emoteCache.clear();for(const o of this.emojis){this.emoteData(o);this.emoteCache.set(o.code,this.emoteData(o))}console.log(this.emoteCache.keys()),Utils.invalidElement(t.app)&&(t.app=document.querySelector("yt-live-chat-app")),!Utils.invalidElement(t.app)&&Utils.invalidElement(t.innerBody)&&(t.innerBody=t.app.closest("body"));t=document.querySelector("#chatframe").contentDocument.querySelector("yt-live-chat-item-list-renderer");const e=document.querySelector("#chatframe")?.contentDocument?.querySelector("yt-live-chat-item-list-renderer")?.emojiManager;if(console.log("\n-------------------------"),console.log(t),console.log(e),console.log("-------------------------\n"),null==t?{}:e){if(console.log(e._ytg),e._ytg)return!1;e._ytg=!0,n.emojiManager.load([...this.emoteCache.values()]),console.log(t),console.log(e),console.log(t.emojiManager)}else console.warn("Cannot find chat list");return console.log("emotes.create 2",t,e),!!Utils.exists(e)&&(console.log(e.emojis),!0)};getEmote=async(e="")=>this.emojis.find(t=>new RegExp(`[s+]?${t.code}[s+]?`,"ig").test(e));getFromCode=(e="")=>this.emojis.filter(t=>t.code.toLowerCase().startsWith(e.toLowerCase()));injectBTTVPicker=async(e=defaultElement)=>{if(Utils.invalidElement(e))return!1;const t=e.querySelector("yt-emoji-picker-renderer.yt-live-chat-message-input-renderer > #categories-wrapper > #categories");if(!Utils.exists(t))return!1;if(Utils.exists(t.querySelector("#bttvEmojis")))return!1;t.children[0].insertAdjacentHTML("afterend",'<yt-emoji-picker-category-renderer class="style-scope yt-emoji-picker-renderer" aria-live="polite" role="listbox" tabindex="0" aria-label="BTTV" id="bttvEmojis" aria-activedescendant="aria-bttvEmojis"><yt-formatted-string id="title" class="style-scope yt-emoji-picker-category-renderer">BTTV</yt-formatted-string><div id="emoji" role="listbox" tabindex="0" class="style-scope yt-emoji-picker-category-renderer imgList" aria-label=""><dom-repeat id="repeat" class="style-scope yt-emoji-picker-category-renderer"><template is="dom-repeat"></template></dom-repeat></div></yt-emoji-picker-category-renderer>');const o=t.querySelector("#bttvEmojis");if(Utils.exists(o)){o.setAttribute("aria-activedescendant","aria-bttvEmojis"),o.setAttribute("aria-label","BTTV"),o.querySelector("yt-formatted-string").innerText="BTTV";const r=o.querySelector('#emoji[role="listbox"]'),a=this.emojis.filter(t=>"bttv"===t.provider);if(Utils.exists(r)){let t="";for(const c of a)t+=`<img height="24" role="option" width="24" class="style-scope yt-emoji-picker-category-renderer bttvEmoji" src="https://cdn.betterttv.net/emote/${c.id}/1x" loading="eager" aria-selected="false" aria-label="${c.code}" label="${c.code}" alt="${c.code}" id="bttv-${c.id}" />`;r.insertAdjacentHTML("afterbegin",t);e=r.getElementsByClassName("bttvEmoji");if(0<e.length){let r="Search emoji";var n=t=>{const e=t||window.event,o=t.currentTarget.getAttribute("label");var r=a.find(t=>t.code===o);if(r){const n=t.currentTarget.closest("yt-live-chat-message-input-renderer > #container");if(Utils.exists(n)){var t=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");if(Utils.exists(t)){const i=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(i)&&(t=i.querySelector("#input"),Utils.exists(t)&&(i.setAttribute("has-text",""),i.dispatchEvent(new Event("character-count-changed")),i?.insertEmoji({isCustomEmoji:!0,shortcuts:[":"+r.code],emojiId:r.code}),i?.focusAtEnd()))}}}e.preventDefault()},i=t=>{const e=t.currentTarget.getAttribute("label");if(a.find(t=>t.code===e)){const o=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(o)){let t=o.querySelector("input");Utils.exists(t)&&(r=""+t.placeholder,t.placeholder=""+e)}}},s=t=>{const e=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(e)){let t=e.querySelector("input");Utils.exists(t)&&(t.placeholder=r)}};for(const l of e)l.addEventListener("click",n,!1),l.addEventListener("mouseover",i,!1),l.addEventListener("mouseout",s,!1)}}}return!0};injectFFZPicker=async(e=defaultElement)=>{if(Utils.invalidElement(e))return!1;const t=e.querySelector("yt-emoji-picker-renderer.yt-live-chat-message-input-renderer > #categories-wrapper > #categories");if(!Utils.exists(t))return!1;if(Utils.exists(t.querySelector("#ffzEmojis")))return!1;t.children[0].insertAdjacentHTML("afterend",'<yt-emoji-picker-category-renderer class="style-scope yt-emoji-picker-renderer" aria-live="polite" role="listbox" tabindex="0" aria-label="FFZ" id="ffzEmojis" aria-activedescendant="aria-ffzEmojis"><yt-formatted-string id="title" class="style-scope yt-emoji-picker-category-renderer">FFZ</yt-formatted-string><div id="emoji" role="listbox" tabindex="0" class="style-scope yt-emoji-picker-category-renderer imgList" aria-label=""><dom-repeat id="repeat" class="style-scope yt-emoji-picker-category-renderer"><template is="dom-repeat"></template></dom-repeat></div></yt-emoji-picker-category-renderer>');const o=t.querySelector("#ffzEmojis");if(Utils.exists(o)){o.setAttribute("aria-activedescendant","aria-ffzEmojis"),o.setAttribute("aria-label","FFZ"),o.querySelector("yt-formatted-string").innerText="FFZ";const r=o.querySelector('#emoji[role="listbox"]'),a=this.emojis.filter(t=>"ffz"===t.provider);if(Utils.exists(r)){let t="";for(const c of a)t+=`<img height="24" role="option" width="24" class="style-scope yt-emoji-picker-category-renderer ffzEmoji" src="https://cdn.betterttv.net/frankerfacez_emote/${c.id}/1" loading="eager" aria-selected="false" aria-label="${c.code}" label="${c.code}" alt="${c.code}" id="ffx-${c.id}" />`;r.insertAdjacentHTML("afterbegin",t);e=r.getElementsByClassName("ffzEmoji");if(0<e.length){let r="Search emoji";var n=t=>{const e=t||window.event,o=t.currentTarget.getAttribute("label");var r=a.find(t=>t.code===o);if(r){const n=t.currentTarget.closest("yt-live-chat-message-input-renderer > #container");if(Utils.exists(n)){const i=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(i)&&(t=i.querySelector("#input"),Utils.exists(t)&&(i.setAttribute("has-text",""),i.dispatchEvent(new Event("character-count-changed")),i?.insertEmoji({isCustomEmoji:!0,shortcuts:[":"+r.code],emojiId:r.code}),i?.focusAtEnd()))}}e.preventDefault()},i=t=>{const e=t.currentTarget.getAttribute("label");if(a.find(t=>t.code===e)){const o=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(o)){let t=o.querySelector("input");Utils.exists(t)&&(r=""+t.placeholder,t.placeholder=""+e)}}},s=t=>{const e=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(e)){let t=e.querySelector("input");Utils.exists(t)&&(t.placeholder=r)}};for(const l of e)l.addEventListener("click",n,!1),l.addEventListener("mouseover",i,!1),l.addEventListener("mouseout",s,!1)}}}return!0};injectSuggestion=(e={...defaultChatElements},t={provider:"",id:"",code:"",src:""},o=":")=>{var r=`emoji-suggest-${t.provider}-`+t.id;const n=e.dropdownContent;if(!Utils.invalidElement(n)&&!Utils.exists(n.querySelector("#"+r))){const i=document.createElement("ytg-live-chat-text-input-field-suggestion"),s=document.createElement("tp-yt-paper-item"),a=document.createElement("img");o={emoji:!0,image:t.src,alt:t.code,text:`:${t.code}:`,author:t.provider,authorType:t.provider,textToReplaceWhenSelected:o.startsWith(":")?o:":"+o,textToInsertWhenSelected:t.code};i.classList.add("style-scope","yt-live-chat-text-input-field-renderer"),Utils.setAttributes(i,{id:r,ytg:""}),Utils.setDataAttributes(i,{...o}),s.classList.add("style-scope","yt-live-chat-text-input-field-suggestion"),s.innerText=`:${t.code}:`,s.addEventListener("mouseover",()=>{i.setAttribute("active","")}),s.addEventListener("mouseout",()=>{i.removeAttribute("active")}),Utils.setAttributes(s,{role:"option",tabindex:"0","aria-disabled":"false"}),s.addEventListener("click",()=>{i.removeAttribute("active");const t=e.textInputFieldRenderer??inputContainer.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(t)&&(Utils.getDataAttributes(i),t.setAttribute("has-text",""),t.dispatchEvent(new Event("character-count-changed")))}),a.classList.add("style-scope","yt-live-chat-text-input-field-suggestion"),Utils.setAttributes(a,{src:t.src,alt:t.code}),s.prepend(a),i.appendChild(s),n.appendChild(i)}};injectSuggestions=(o={...defaultChatElements},e="")=>{var r=(t=void 0)=>{if(Utils.exists(o.dropdownContent))for(const e of o.dropdownContent.children)Utils.exists(e)&&(e.removeAttribute("active"),e.querySelector("tp-yt-paper-item").removeAttribute("active"),("YTG-LIVE-CHAT-TEXT-INPUT-FIELD-SUGGESTION"===e.tagName||t&&!e.innerText.toLowerCase().startsWith((":"+t).toLowerCase()))&&o.dropdownContent.removeChild(e));return!0};if(console.log("emotes.injectSuggestions",e),e.includes(":")){var n=e.trim().split(":").pop().split(" ")[0];if(console.log("code",n),!(n.length<2)){e=this.getFromCode(n);if(console.log("foundEmotes",e),0<e.length){if(Utils.exists(o.dropdownContent)){r(n);for(const i of e)this.injectSuggestion(o,i,n);let t=Array.from(o.dropdownContent.children).at(-1);Utils.exists(t)&&(t.setAttribute("active",""),t.querySelector("tp-yt-paper-item").setAttribute("active","")),o.dropdownContent.scrollTop=o.dropdownContent.scrollHeight,o.ironDropdown.style.setProperty("display","")}}else r(n)}}else"none"!==o.ironDropdown.style.display&&(r(),o.ironDropdown.style.setProperty("display","none"))};addToMessage=async t=>{var e,o=/[&\/\\#,+()$~%.'":*?<>{}]/gim;for(e of Utils.splitMessage(t)){e=e.replace(o,"");var r=await this.getEmote(e);r&&!this.excludesWords.includes(e.toLowerCase())&&(t=t.replace(new RegExp(`(?!")${e}(?!")`),Utils.emoteToImage(r)))}return t};insertTo=async(t=defaultElement)=>(Utils.invalidElement(t)||(t.innerHTML=await this.addToMessage(t.innerHTML)),t);clean=t=>t.filter(t=>!this.excludesWords.includes(t.code.toLowerCase()));mergeFFZ=(t,e)=>{this.ffz=this.ffz.concat(t.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)))};mergeBTTV=(t,e)=>{this.bttv=this.bttv.concat(t.channelEmotes.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)),t.sharedEmotes.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)))};loadFFZ=async(e="")=>{if(!this.chatSettings.ffzEmotes)return!(this.ffz=[]);console.info("[YouTubeGaming+] Loading FFZ Emotes...");try{var t,o=supportedChannels.find(t=>t.youtube.name===e.toLowerCase());void 0!==o&&(t=await Utils.fetchJSON("https://api.betterttv.net/3/cached/frankerfacez/users/twitch/"+o.twitch.id),this.mergeFFZ(t,o.twitch.id))}catch(t){console.log("FFZ Twitch Request failed",t)}try{const r=await Utils.fetchJSON("https://api.betterttv.net/3/cached/frankerfacez/emotes/global");this.ffz=this.ffz.concat(r.map(t=>(t.global=!0,t)))}catch(t){console.log("FFZ Request failed",t)}return this.ffz=this.clean(this.ffz),console.info("[YouTubeGaming+] FFZ Emotes Loaded!",this.ffz.length),!0};loadBTTV=async(e="")=>{if(!this.chatSettings.bttvEmotes)return!(this.bttv=[]);console.info("[YouTubeGaming+] Loading BTTV Emotes...");try{var t,o=supportedChannels.find(t=>t.youtube.name===e.toLowerCase());void 0!==o&&(t=await Utils.fetchJSON("https://api.betterttv.net/3/cached/users/twitch/"+o.twitch.id),this.mergeBTTV(t,o.twitch.id))}catch(t){console.log("BTTV Twitch Request failed",t)}try{const r=await Utils.fetchJSON("https://api.betterttv.net/3/cached/emotes/global");this.bttv=this.bttv.concat(r.map(t=>(t.global=!0,t)))}catch(t){console.log("BTTV Request failed",t)}return this.bttv=this.clean(this.bttv),console.info("[YouTubeGaming+] BTTV Emotes Loaded!",this.bttv.length),!0};load=async(t="",e={...defaultChatElements})=>{this.chatElements=e;try{0===this.bttv.length&&await this.loadBTTV(t)}catch{}try{0===this.ffz.length&&await this.loadFFZ(t)}catch{}try{await this.build()}catch{}return!0};emojiPickerObserver=new MutationObserver(t=>{for(const e of t){const o=e.target;Utils.exists(o)&&o.hasAttribute("selected")&&(this.chatSettings.ffzEmotes&&this.injectFFZPicker(o),this.chatSettings.bttvEmotes&&this.injectBTTVPicker(o),this.emojiPickerObserver.disconnect())}})}