!function(){"use strict";var c=window.Document.prototype.createElement,l=window.Document.prototype.createElementNS,d=window.Document.prototype.importNode,u=window.Document.prototype.prepend,h=window.Document.prototype.append,p=window.DocumentFragment.prototype.prepend,f=window.DocumentFragment.prototype.append,m=window.Node.prototype.cloneNode,y=window.Node.prototype.appendChild,g=window.Node.prototype.insertBefore,v=window.Node.prototype.removeChild,b=window.Node.prototype.replaceChild,w=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),E=window.Element.prototype.attachShadow,C=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),_=window.Element.prototype.getAttribute,j=window.Element.prototype.setAttribute,S=window.Element.prototype.removeAttribute,T=window.Element.prototype.getAttributeNS,x=window.Element.prototype.setAttributeNS,N=window.Element.prototype.removeAttributeNS,k=window.Element.prototype.insertAdjacentElement,A=window.Element.prototype.insertAdjacentHTML,D=window.Element.prototype.prepend,O=window.Element.prototype.append,L=window.Element.prototype.before,U=window.Element.prototype.after,M=window.Element.prototype.replaceWith,F=window.Element.prototype.remove,P=window.HTMLElement,z=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),q=window.HTMLElement.prototype.insertAdjacentElement,$=window.HTMLElement.prototype.insertAdjacentHTML,r=new Set;function i(t){var e=r.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!e&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach(function(t){return r.add(t)});var n=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function H(t){var e=t.isConnected;if(void 0!==e)return e;if(n(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function B(t){var e=t.children;if(e)return Array.prototype.slice.call(e);for(e=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&e.push(t);return e}function a(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function I(){var t=!(null==at||!at.noDocumentConstructionObserver),e=!(null==at||!at.shadyDomFastWalk);this.m=[],this.g=[],this.j=!1,this.shadyDomFastWalk=e,this.I=!t}function R(t,e,r,i){var n=window.ShadyDOM;if(t.shadyDomFastWalk&&n&&n.inUse){if(e.nodeType===Node.ELEMENT_NODE&&r(e),e.querySelectorAll)for(t=n.nativeMethods.querySelectorAll.call(e,"*"),e=0;e<t.length;e++)r(t[e])}else!function t(e,r,i){for(var n=e;n;){if(n.nodeType===Node.ELEMENT_NODE){var o=n;r(o);var s=o.localName;if("link"===s&&"import"===o.getAttribute("rel")){if(n=o.import,void 0===i&&(i=new Set),n instanceof Node&&!i.has(n))for(i.add(n),n=n.firstChild;n;n=n.nextSibling)t(n,r,i);n=a(e,o);continue}if("template"===s){n=a(e,o);continue}if(o=o.__CE_shadowRoot)for(o=o.firstChild;o;o=o.nextSibling)t(o,r,i)}n=n.firstChild||a(e,n)}}(e,r,i)}function V(e,t){e.j&&R(e,t,function(t){return W(e,t)})}function W(t,e){if(t.j&&!e.__CE_patched){e.__CE_patched=!0;for(var r=0;r<t.m.length;r++)t.m[r](e);for(r=0;r<t.g.length;r++)t.g[r](e)}}function Z(t,e){var r=[];for(R(t,e,function(t){return r.push(t)}),e=0;e<r.length;e++){var i=r[e];1===i.__CE_state?t.connectedCallback(i):K(t,i)}}function G(t,e){var r=[];for(R(t,e,function(t){return r.push(t)}),e=0;e<r.length;e++){var i=r[e];1===i.__CE_state&&t.disconnectedCallback(i)}}function J(i,t,e){var n=(e=void 0===e?{}:e).J,o=e.upgrade||function(t){return K(i,t)},s=[];for(R(i,t,function(r){var t;i.j&&W(i,r),"link"===r.localName&&"import"===r.getAttribute("rel")?((t=r.import)instanceof Node&&(t.__CE_isImportDocument=!0,t.__CE_registry=document.__CE_registry),t&&"complete"===t.readyState?t.__CE_documentLoadHandled=!0:r.addEventListener("load",function(){var e,t=r.import;t.__CE_documentLoadHandled||(t.__CE_documentLoadHandled=!0,e=new Set,n&&(n.forEach(function(t){return e.add(t)}),e.delete(t)),J(i,t,{J:e,upgrade:o}))})):s.push(r)},n),t=0;t<s.length;t++)o(s[t])}function K(t,e){try{var r=e.ownerDocument,i=r.__CE_registry;if((o=i&&(r.defaultView||r.__CE_isImportDocument)?it(i,e.localName):void 0)&&void 0===e.__CE_state){o.constructionStack.push(e);try{try{if(new o.constructorFunction!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{o.constructionStack.pop()}}catch(t){throw e.__CE_state=2,t}if(e.__CE_state=1,(e.__CE_definition=o).attributeChangedCallback&&e.hasAttributes())for(var n=o.observedAttributes,o=0;o<n.length;o++){var s=n[o],a=e.getAttribute(s);null!==a&&t.attributeChangedCallback(e,s,null,a,null)}H(e)&&t.connectedCallback(e)}}catch(t){Y(t)}}function X(e,r,i,n){var t=r.__CE_registry;if(t&&(null===n||"http://www.w3.org/1999/xhtml"===n)&&(t=it(t,i)))try{var o=new t.constructorFunction;if(void 0===o.__CE_state||void 0===o.__CE_definition)throw Error("Failed to construct '"+i+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==o.namespaceURI)throw Error("Failed to construct '"+i+"': The constructed element's namespace must be the HTML namespace.");if(o.hasAttributes())throw Error("Failed to construct '"+i+"': The constructed element must not have any attributes.");if(null!==o.firstChild)throw Error("Failed to construct '"+i+"': The constructed element must not have any children.");if(null!==o.parentNode)throw Error("Failed to construct '"+i+"': The constructed element must not have a parent node.");if(o.ownerDocument!==r)throw Error("Failed to construct '"+i+"': The constructed element's owner document is incorrect.");if(o.localName!==i)throw Error("Failed to construct '"+i+"': The constructed element's local name is incorrect.");return o}catch(t){return Y(t),r=null===n?c.call(r,i):l.call(r,n,i),Object.setPrototypeOf(r,HTMLUnknownElement.prototype),r.__CE_state=2,r.__CE_definition=void 0,W(e,r),r}return W(e,r=null===n?c.call(r,i):l.call(r,n,i)),r}function Y(t){var e=t.message,r=t.sourceURL||t.fileName||"",i=t.line||t.lineNumber||0,n=t.column||t.columnNumber||0,o=void 0;void 0===ErrorEvent.prototype.initErrorEvent?o=new ErrorEvent("error",{cancelable:!0,message:e,filename:r,lineno:i,colno:n,error:t}):((o=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,e,r,i),o.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===o.error&&Object.defineProperty(o,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(o),o.defaultPrevented}function o(){var e=this;this.g=void 0,this.F=new Promise(function(t){e.l=t})}function e(t){var e=document;this.l=void 0,this.h=t,this.g=e,J(this.h,this.g),"loading"===this.g.readyState&&(this.l=new MutationObserver(this.G.bind(this)),this.l.observe(this.g,{childList:!0,subtree:!0}))}function s(t){t.l&&t.l.disconnect()}function Q(t){this.s=new Map,this.u=new Map,this.C=new Map,this.A=!1,this.B=new Map,this.o=function(t){return t()},this.i=!1,this.v=[],this.h=t,this.D=t.I?new e(t):void 0}function tt(t,e){if(!i(e))throw new SyntaxError("The element name '"+e+"' is not valid.");if(it(t,e))throw Error("A custom element with name '"+e+"' has already been defined.");if(t.A)throw Error("A custom element is already being defined.")}function et(t,e,r){var i;t.A=!0;try{var n=r.prototype;if(!(n instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var o=function(t){var e=n[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},s=o("connectedCallback"),a=o("disconnectedCallback"),c=o("adoptedCallback"),l=(i=o("attributeChangedCallback"))&&r.observedAttributes||[]}catch(t){throw t}finally{t.A=!1}return t.u.set(e,r={localName:e,constructorFunction:r,connectedCallback:s,disconnectedCallback:a,adoptedCallback:c,attributeChangedCallback:i,observedAttributes:l,constructionStack:[]}),t.C.set(r.constructorFunction,r),r}function rt(i){if(!1!==i.i){i.i=!1;for(var n=[],t=i.v,o=new Map,e=0;e<t.length;e++)o.set(t[e],[]);for(J(i.h,document,{upgrade:function(t){var e,r;void 0===t.__CE_state&&(e=t.localName,(r=o.get(e))?r.push(t):i.u.has(e)&&n.push(t))}}),e=0;e<n.length;e++)K(i.h,n[e]);for(e=0;e<t.length;e++){for(var r=t[e],s=o.get(r),a=0;a<s.length;a++)K(i.h,s[a]);(r=i.B.get(r))&&r.resolve(void 0)}t.length=0}}function it(t,e){var r=t.u.get(e);if(r)return r;if(r=t.s.get(e)){t.s.delete(e);try{return et(t,e,r())}catch(t){Y(t)}}}function nt(a,t,e){function r(s){return function(t){for(var e=[],r=0;r<arguments.length;++r)e[r]=arguments[r];for(var r=[],i=[],n=0;n<e.length;n++){var o=e[n];if(o instanceof Element&&H(o)&&i.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)r.push(o);else r.push(o)}for(s.apply(this,e),e=0;e<i.length;e++)G(a,i[e]);if(H(this))for(e=0;e<r.length;e++)(i=r[e])instanceof Element&&Z(a,i)}}void 0!==e.prepend&&(t.prepend=r(e.prepend)),void 0!==e.append&&(t.append=r(e.append))}function ot(s){function e(t,o){Object.defineProperty(t,"innerHTML",{enumerable:o.enumerable,configurable:!0,get:o.get,set:function(t){var e=this,r=void 0;if(H(this)&&(r=[],R(s,this,function(t){t!==e&&r.push(t)})),o.set.call(this,t),r)for(var i=0;i<r.length;i++){var n=r[i];1===n.__CE_state&&s.disconnectedCallback(n)}return(this.ownerDocument.__CE_registry?J:V)(s,this),t}})}function t(t,i){t.insertAdjacentElement=function(t,e){var r=H(e);return t=i.call(this,t,e),r&&G(s,e),H(t)&&Z(s,e),t}}function r(t,i){function n(t,e){for(var r=[];t!==e;t=t.nextSibling)r.push(t);for(e=0;e<r.length;e++)J(s,r[e])}t.insertAdjacentHTML=function(t,e){if("beforebegin"===(t=t.toLowerCase())){var r=this.previousSibling;i.call(this,t,e),n(r||this.parentNode.firstChild,this)}else if("afterbegin"===t)r=this.firstChild,i.call(this,t,e),n(this.firstChild,r);else if("beforeend"===t)r=this.lastChild,i.call(this,t,e),n(r||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");r=this.nextSibling,i.call(this,t,e),n(this.nextSibling,r)}}}var i,a,n;function o(s){return function(t){for(var e=[],r=0;r<arguments.length;++r)e[r]=arguments[r];for(var r=[],i=[],n=0;n<e.length;n++){var o=e[n];if(o instanceof Element&&H(o)&&i.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)r.push(o);else r.push(o)}for(s.apply(this,e),e=0;e<i.length;e++)G(a,i[e]);if(H(this))for(e=0;e<r.length;e++)(i=r[e])instanceof Element&&Z(a,i)}}E&&(Element.prototype.attachShadow=function(t){if(t=E.call(this,t),s.j&&!t.__CE_patched){t.__CE_patched=!0;for(var e=0;e<s.m.length;e++)s.m[e](t)}return this.__CE_shadowRoot=t}),C&&C.get?e(Element.prototype,C):z&&z.get?e(HTMLElement.prototype,z):(n=function(t){e(t,{enumerable:!0,configurable:!0,get:function(){return m.call(this,!0).innerHTML},set:function(t){var e="template"===this.localName,r=e?this.content:this,i=l.call(document,this.namespaceURI,this.localName);for(i.innerHTML=t;0<r.childNodes.length;)v.call(r,r.childNodes[0]);for(t=e?i.content:i;0<t.childNodes.length;)y.call(r,t.childNodes[0])}})},(i=s).j=!0,i.g.push(n)),Element.prototype.setAttribute=function(t,e){if(1!==this.__CE_state)return j.call(this,t,e);var r=_.call(this,t);j.call(this,t,e),e=_.call(this,t),s.attributeChangedCallback(this,t,r,e,null)},Element.prototype.setAttributeNS=function(t,e,r){if(1!==this.__CE_state)return x.call(this,t,e,r);var i=T.call(this,t,e);x.call(this,t,e,r),r=T.call(this,t,e),s.attributeChangedCallback(this,e,i,r,t)},Element.prototype.removeAttribute=function(t){if(1!==this.__CE_state)return S.call(this,t);var e=_.call(this,t);S.call(this,t),null!==e&&s.attributeChangedCallback(this,t,e,null,null)},Element.prototype.removeAttributeNS=function(t,e){if(1!==this.__CE_state)return N.call(this,t,e);var r=T.call(this,t,e);N.call(this,t,e);var i=T.call(this,t,e);r!==i&&s.attributeChangedCallback(this,e,r,i,t)},q?t(HTMLElement.prototype,q):k&&t(Element.prototype,k),$?r(HTMLElement.prototype,$):A&&r(Element.prototype,A),nt(s,Element.prototype,{prepend:D,append:O}),a=s,n=Element.prototype,void 0!==L&&(n.before=o(L)),void 0!==U&&(n.after=o(U)),void 0!==M&&(n.replaceWith=function(t){for(var e=[],r=0;r<arguments.length;++r)e[r]=arguments[r];for(var r=[],i=[],n=0;n<e.length;n++){var o=e[n];if(o instanceof Element&&H(o)&&i.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)r.push(o);else r.push(o)}for(n=H(this),M.apply(this,e),e=0;e<i.length;e++)G(a,i[e]);if(n)for(G(a,this),e=0;e<r.length;e++)(i=r[e])instanceof Element&&Z(a,i)}),void 0!==F&&(n.remove=function(){var t=H(this);F.call(this),t&&G(a,this)})}I.prototype.connectedCallback=function(t){var e=t.__CE_definition;if(e.connectedCallback)try{e.connectedCallback.call(t)}catch(t){Y(t)}},I.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;if(e.disconnectedCallback)try{e.disconnectedCallback.call(t)}catch(t){Y(t)}},I.prototype.attributeChangedCallback=function(t,e,r,i,n){var o=t.__CE_definition;if(o.attributeChangedCallback&&-1<o.observedAttributes.indexOf(e))try{o.attributeChangedCallback.call(t,e,r,i,n)}catch(t){Y(t)}},o.prototype.resolve=function(t){if(this.g)throw Error("Already resolved.");this.g=t,this.l(t)},e.prototype.G=function(t){var e=this.g.readyState;for("interactive"!==e&&"complete"!==e||s(this),e=0;e<t.length;e++)for(var r=t[e].addedNodes,i=0;i<r.length;i++)J(this.h,r[i])},Q.prototype.H=function(t,e){var r=this;if(!(e instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");tt(this,t),this.s.set(t,e),this.v.push(t),this.i||(this.i=!0,this.o(function(){return rt(r)}))},Q.prototype.define=function(t,e){var r=this;if(!(e instanceof Function))throw new TypeError("Custom element constructors must be functions.");tt(this,t),et(this,t,e),this.v.push(t),this.i||(this.i=!0,this.o(function(){return rt(r)}))},Q.prototype.upgrade=function(t){J(this.h,t)},Q.prototype.get=function(t){if(t=it(this,t))return t.constructorFunction},Q.prototype.whenDefined=function(t){if(!i(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var e=this.B.get(t);if(e)return e.F;e=new o,this.B.set(t,e);var r=this.u.has(t)||this.s.has(t);return t=-1===this.v.indexOf(t),r&&t&&e.resolve(void 0),e.F},Q.prototype.polyfillWrapFlushCallback=function(e){this.D&&s(this.D);var r=this.o;this.o=function(t){return e(function(){return r(t)})}},(window.CustomElementRegistry=Q).prototype.polyfillDefineLazy=Q.prototype.H;var st={};var at=window.customElements;function t(){var o,r,s,t,e,i=new I;function n(){var t=this.constructor,e=document.__CE_registry.C.get(t);if(!e)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var r=e.constructionStack;if(0===r.length)return r=c.call(document,e.localName),Object.setPrototypeOf(r,t.prototype),r.__CE_state=1,r.__CE_definition=e,W(o,r),r;var i=r.length-1,n=r[i];if(n===st)throw Error("Failed to construct '"+e.localName+"': This element was already constructed.");return r[i]=st,Object.setPrototypeOf(n,t.prototype),W(o,n),n}function a(t,o){Object.defineProperty(t,"textContent",{enumerable:o.enumerable,configurable:!0,get:o.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)o.set.call(this,t);else{var e=void 0;if(this.firstChild){var r=this.childNodes,i=r.length;if(0<i&&H(this))for(var e=Array(i),n=0;n<i;n++)e[n]=r[n]}if(o.set.call(this,t),e)for(t=0;t<e.length;t++)G(s,e[t])}}})}o=i,n.prototype=P.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:n}),window.HTMLElement=n,r=i,Document.prototype.createElement=function(t){return X(r,this,t,null)},Document.prototype.importNode=function(t,e){return t=d.call(this,t,!!e),(this.__CE_registry?J:V)(r,t),t},Document.prototype.createElementNS=function(t,e){return X(r,this,e,t)},nt(r,Document.prototype,{prepend:u,append:h}),nt(i,DocumentFragment.prototype,{prepend:p,append:f}),s=i,Node.prototype.insertBefore=function(t,e){if(t instanceof DocumentFragment){var r=B(t);if(t=g.call(this,t,e),H(this))for(e=0;e<r.length;e++)Z(s,r[e]);return t}return r=t instanceof Element&&H(t),e=g.call(this,t,e),r&&G(s,t),H(this)&&Z(s,t),e},Node.prototype.appendChild=function(t){if(t instanceof DocumentFragment){var e=B(t);if(t=y.call(this,t),H(this))for(var r=0;r<e.length;r++)Z(s,e[r]);return t}return e=t instanceof Element&&H(t),r=y.call(this,t),e&&G(s,t),H(this)&&Z(s,t),r},Node.prototype.cloneNode=function(t){return t=m.call(this,!!t),(this.ownerDocument.__CE_registry?J:V)(s,t),t},Node.prototype.removeChild=function(t){var e=t instanceof Element&&H(t),r=v.call(this,t);return e&&G(s,t),r},Node.prototype.replaceChild=function(t,e){if(t instanceof DocumentFragment){var r=B(t);if(t=b.call(this,t,e),H(this))for(G(s,e),e=0;e<r.length;e++)Z(s,r[e]);return t}var r=t instanceof Element&&H(t),i=b.call(this,t,e),n=H(this);return n&&G(s,e),r&&G(s,t),n&&Z(s,t),i},w&&w.get?a(Node.prototype,w):(e=function(t){a(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=this.firstChild;e;e=e.nextSibling)e.nodeType!==Node.COMMENT_NODE&&t.push(e.textContent);return t.join("")},set:function(t){for(;this.firstChild;)v.call(this,this.firstChild);null!=t&&""!==t&&y.call(this,document.createTextNode(t))}})},(t=s).j=!0,t.m.push(e)),ot(i),i=new Q(i),document.__CE_registry=i,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:i})}at&&!at.forcePolyfill&&"function"==typeof at.define&&"function"==typeof at.get||t(),window.__CE_installPolyfill=t}.call(self);const visualSettingsKey="youTubeGamingPlus.visualSettings",chatUsersKey="youTubeGamingPlus.chatters",defaultVisualSettings={chat:{nameColor:!0,icon:!0,showDeleted:!1,simulatedDelay:!1,separatedLines:!0,bttvEmotes:!0,ffzEmotes:!0},theatreMode:!0,showReplayChat:!0,qualityOptimization:!1},defaultChatElements={target:document.createElement("div"),app:void 0,innerBody:void 0,dropdown:void 0,modes:void 0,inputRenderer:void 0,textInputFieldRenderer:void 0,inputField:void 0,ironDropdown:void 0,dropdownContent:void 0},supportedChannels=[{youtube:{name:"blurrypenguin",enable:!0},twitch:{name:"blurrypenguin",id:134609363}},{youtube:{name:"valkyrae",enable:!0},twitch:{name:"valkyrae",id:79615025}},{youtube:{name:"courage",enable:!0},twitch:{name:"couragejd",id:106125347}},{youtube:{name:"timthetatman",enable:!0},twitch:{name:"timthetatman",id:36769016}},{youtube:{name:"drlupo",enable:!0},twitch:{name:"drlupo",id:29829912}},{youtube:{name:"ludwig",enable:!1},twitch:{name:"ludwig",id:40934651}}],defaultEmoji={emojiId:"ytg-0674b390-c5e2-464a-bc48-8ff6c70a03d6",image:{accessibility:{accessibilityData:{label:"yt"}},thumbnails:[{height:24,url:"",width:24},{height:48,url:"",width:48}]},isCustomEmoji:!0,searchTerms:[""],shortcuts:["::"]},defaultElement=document.createElement("empty");class Chrome{static getProto=t=>t.constructor.prototype||Object.getPrototypeOf(t);static getMethods=e=>{let r=new Set,t=e;for(;Object.getOwnPropertyNames(t).map(t=>r.add(t)),t=Object.getPrototypeOf(t););return[...r.keys()].filter(t=>"function"==typeof e[t])};static getProps=t=>{let e=[];for(;null!=t;t=Object.getPrototypeOf(t)){var r=Object.getOwnPropertyNames(t);for(let t=0;t<r.length;t++)-1==e.indexOf(r[t])&&e.push(r[t])}return e};static getFunctions=t=>{t=t.constructor.prototype;return Object.getOwnPropertyNames(t).filter(t=>"function"==typeof String.prototype[t])}}class Utils{static isNumber=t=>"number"==typeof t&&isFinite(t);static isBoolean=t=>"boolean"==typeof val;static canRun=(t,e)=>!!t.test(e);static uuid=()=>crypto.randomUUID();static uuid4=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));static exists=t=>null!=t;static invalidElement=t=>!this.exists(t)||""===t.tagName||"empty"===t.tagName;static generatePastelColor=()=>{let t=(Math.floor(127*Math.random()+127)<<16)+(Math.floor(127*Math.random()+127)<<8)+Math.floor(127*Math.random()+127);return"#"+t.toString(16)};static getDocument=t=>t.contentDocument||t.contentWindow.document;static zt=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?function(t){return ShadyDOM.patch(t)}:function(t){return t};static fire=(t,e,r)=>{r=r||{},e=null==e?{}:e;const i=new Event(t,{bubbles:void 0===r.bubbles||r.bubbles,cancelable:!!r.cancelable,composed:void 0===r.composed||r.composed});return i.detail=e,window.dispatchEvent(i),i};static getMethods=e=>{let r=new Set,t=e;for(;Object.getOwnPropertyNames(t).map(t=>r.add(t)),t=Object.getPrototypeOf(t););return[...r.keys()].filter(t=>"function"==typeof e[t])};static randomInt=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;static splitMessage=t=>{return t.split(/\s*(<[^>]*>)|[\s.,?!\/]/gim).filter(Boolean)};static emoteToImage=({provider:t,src:e,code:r,id:i})=>`<img class="emoji ${t} yt-formatted-string style-scope yt-live-chat-text-message-renderer" src="${e}" alt="${r}" title="${r}" shared-tooltip-text="${r}" id="emoji-${t}-${i}" />`;static insertImages=(t,e)=>Object.entries({[e.code]:e}).reduce((t,[,{provider:e,src:r,code:i,id:n}])=>t.replace(new RegExp(`[s+]?${i}[s+]?`),`<img class="emoji ${e} yt-formatted-string style-scope yt-live-chat-text-message-renderer" src="${r}" alt="${i}" title="${i}" shared-tooltip-text="${i}" id="emoji-${e}-${n}" />`),t);static fetchJSON=async(t,e={node:"cors"})=>{try{const r=await(t=>{if(!t.ok)throw Error(t.statusText);return t})(await fetch(t,e));return r.json()}catch(t){throw Error(t)}};static camelCaseToDashed=t=>t.replace(/[A-Z]/g,t=>"-"+t.toLowerCase());static dashToCamelCase=t=>t.split("-").reduce((t,e)=>t+e.charAt(0).toUpperCase()+e.slice(1));static dataToKey=t=>{const e=this.dashToCamelCase(t).replace("data-","");return e.charAt(0).toLowerCase()+e.slice(1)};static setAttributes=(e,r)=>Object.keys(r).forEach(t=>e.setAttribute(t,r[t]));static setDataAttributes=(e,r={})=>Object.keys(r).forEach(t=>e.setAttribute("data-"+this.camelCaseToDashed(t),r[t]));static getDataAttributes=t=>{let e={};var r=t.dataset;for(const n in r){var i=r[n];this.isBoolean(i)?e[n]=Boolean(i):this.isNumber(i)?e[n]=Number(i):e[n]=i}return e};static sendMessage=async i=>new Promise((e,r)=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{chrome.tabs.sendMessage(t[0].id,{type:"youtubegaming+",system:"ytg+",tabId:t[0].id,...i},t=>chrome.runtime.lastError?r({success:!1,data:i,error:chrome.runtime.lastError.message}):e(t))})});static A={OverrideFunction:0,RunBefore:1,RunAfter:2};static C=(t,e,{locked:r})=>({functionName:t,function:e,locked:r||!1,type:this.A.RunBefore});static I=async(t,r)=>{await customElements.whenDefined(t);const e=customElements.get(t);if(e){const i=e.prototype[r.functionName];e.prototype[r.functionName]=function(...t){if(i.apply(this,t),r.type===Utils.A.OverrideFunction)try{return r.function.apply(this,t)}catch(t){}if(r.type===Utils.A.RunBefore)try{r.function.apply(this,t)}catch(t){}let e=i.apply(this,t);if(r.type===Utils.A.RunAfter)try{e=r.function.apply(this,[e])}catch(t){}return e}}}}class Storage{static removeLocal=async(t="")=>{try{return await chrome.storage.local.remove(t),!0}catch{throw new Error(!1)}};static removeSync=async(t="")=>{try{return await chrome.storage.sync.remove(t),!0}catch{throw new Error(!1)}};static getLocalBytesInUse=async(t="")=>{try{var e=await chrome.storage.local.getBytesInUse(t);return Promise.resolve(e)}catch{throw new Error(!1)}};static getSyncBytesInUse=async(t="")=>{try{var e=await chrome.storage.sync.getBytesInUse(t);return Promise.resolve(e)}catch{throw new Error(!1)}};static getLocal=async(t="",e=null)=>{try{var r=await chrome.storage.local.get(t);return Promise.resolve(r[t]??e)}catch{throw new Error(e)}};static getSync=async(t="",e=null)=>{try{var r=await chrome.storage.sync.get(t);return Promise.resolve(r[t]??e)}catch{throw new Error(e)}};static setLocal=async(t="",e=null)=>{try{return await this.removeLocal(t),await chrome.storage.local.set({[t]:e}),Promise.resolve(!0)}catch{throw new Error(e)}};static setSync=async(t="",e=null)=>{try{return await this.removeSync(t),await chrome.storage.sync.set({[t]:e}),Promise.resolve(!0)}catch{throw new Error(e)}}}class Mutations{mutations=[];add(e,t,r,i={},n=!0){const o=this.mutations.find(t=>t.id===e),s=new MutationObserver((t,e)=>r(t,e));return o?(o.target=t,o.callback=r,o.options=i,o.o.disconnect(),o.o=s):(this.mutations.push({id:e,target:t,o:s,callback:r,options:i}),n&&s.observe(t,i)),s}observe(e){const t=this.mutations.find(t=>t.id===e);t&&t.o.observe(t.target,t.options)}disconnect(e){const t=this.mutations.find(t=>t.id===e);t&&t.o.disconnect()}flush(){for(const t of this.mutations)t&&t.o.disconnect();this.mutations=[]}}class Emotes{bttv=[];ffz=[];emojis=[];emoteCache=new Map;chatSettings={...defaultVisualSettings.chat};chatElements={...defaultChatElements};excludesWords=["name"];constructor(t={settings:defaultVisualSettings.chat}){this.chatSettings={...t.settings},this.emoteCache.clear()}get chatSettings(){return this.chatSettings}set chatSettings(t=defaultVisualSettings.chat){this.chatSettings=t}get bttv(){return this.bttv}get ffz(){return this.ffz}build=async()=>{const t=[];if(this.chatSettings.bttvEmotes)for(const e of this.bttv)e.id&&e.code&&t.push({provider:"bttv",id:e.id,code:e.code,src:`https://cdn.betterttv.net/emote/${e.id}/1x`});if(this.chatSettings.ffzEmotes)for(const r of this.ffz)r.id&&r.code&&r.images&&t.push({provider:"ffz",id:r.id,code:r.code,src:""+r.images["1x"]});return this.emojis=t,t};emoteData=t=>{let e=`https://cdn.betterttv.net/emote/${t.id}/1x`;"twitch"===t.provider?e=`https://static-cdn.jtvnw.net/emoticons/v2/${t.id}/static/dark/1.0`:"ffz"===t.provider&&(e=`https://cdn.frankerfacez.com/emote/${t.id}/1`);var r=t.code.replace(/:/g,"");return{emojiId:"ytg-"+r+"-"+t.id,image:{thumbnails:[{url:e}],accessibility:{accessibilityData:{label:r}}},isCustomEmoji:!0,searchTerms:[r],shortcuts:[":"+r+":",r]}};create=async(t={...defaultChatElements})=>{if(this.emojis.length<=0||0<this.emoteCache.size)return!1;this.emoteCache.clear();for(const r of this.emojis){this.emoteData(r);this.emoteCache.set(r.code,this.emoteData(r))}Utils.invalidElement(t.app)&&(t.app=document.querySelector("yt-live-chat-app")),!Utils.invalidElement(t.app)&&Utils.invalidElement(t.innerBody)&&(t.innerBody=t.app.closest("body"));t=document.querySelector("#chatframe").contentDocument.querySelector("yt-live-chat-item-list-renderer");const e=document.querySelector("#chatframe")?.contentDocument?.querySelector("yt-live-chat-item-list-renderer")?.emojiManager;if(null==t?{}:e){if(e._ytg)return!1;e._ytg=!0,n.emojiManager.load([...this.emoteCache.values()])}return!!Utils.exists(e)};getEmote=async(e="")=>this.emojis.find(t=>new RegExp(`[s+]?${t.code}[s+]?`,"ig").test(e));getFromCode=(e="")=>this.emojis.filter(t=>t.code.toLowerCase().startsWith(e.toLowerCase()));injectBTTVPicker=async(e=defaultElement)=>{if(Utils.invalidElement(e))return!1;const t=e.querySelector("yt-emoji-picker-renderer.yt-live-chat-message-input-renderer > #categories-wrapper > #categories");if(!Utils.exists(t))return!1;if(Utils.exists(t.querySelector("#bttvEmojis")))return!1;t.children[0].insertAdjacentHTML("afterend",'<yt-emoji-picker-category-renderer class="style-scope yt-emoji-picker-renderer" aria-live="polite" role="listbox" tabindex="0" aria-label="BTTV" id="bttvEmojis" aria-activedescendant="aria-bttvEmojis"><yt-formatted-string id="title" class="style-scope yt-emoji-picker-category-renderer">BTTV</yt-formatted-string><div id="emoji" role="listbox" tabindex="0" class="style-scope yt-emoji-picker-category-renderer imgList" aria-label=""><dom-repeat id="repeat" class="style-scope yt-emoji-picker-category-renderer"><template is="dom-repeat"></template></dom-repeat></div></yt-emoji-picker-category-renderer>');const r=t.querySelector("#bttvEmojis");if(Utils.exists(r)){r.setAttribute("aria-activedescendant","aria-bttvEmojis"),r.setAttribute("aria-label","BTTV"),r.querySelector("yt-formatted-string").innerText="BTTV";const i=r.querySelector('#emoji[role="listbox"]'),a=this.emojis.filter(t=>"bttv"===t.provider);if(Utils.exists(i)){let t="";for(const c of a)t+=`<img height="24" role="option" width="24" class="style-scope yt-emoji-picker-category-renderer bttvEmoji" src="https://cdn.betterttv.net/emote/${c.id}/1x" loading="eager" aria-selected="false" aria-label="${c.code}" label="${c.code}" alt="${c.code}" id="bttv-${c.id}" />`;i.insertAdjacentHTML("afterbegin",t);e=i.getElementsByClassName("bttvEmoji");if(0<e.length){let i="Search emoji";var n=t=>{const e=t||window.event,r=t.currentTarget.getAttribute("label");var i=a.find(t=>t.code===r);if(i){const n=t.currentTarget.closest("yt-live-chat-message-input-renderer > #container");if(Utils.exists(n)){var t=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");if(Utils.exists(t)){const o=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(o)&&(t=o.querySelector("#input"),Utils.exists(t)&&(o.setAttribute("has-text",""),o.dispatchEvent(new Event("character-count-changed")),o?.insertEmoji({isCustomEmoji:!0,shortcuts:[":"+i.code],emojiId:i.code}),o?.focusAtEnd()))}}}e.preventDefault()},o=t=>{const e=t.currentTarget.getAttribute("label");if(a.find(t=>t.code===e)){const r=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(r)){let t=r.querySelector("input");Utils.exists(t)&&(i=""+t.placeholder,t.placeholder=""+e)}}},s=t=>{const e=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(e)){let t=e.querySelector("input");Utils.exists(t)&&(t.placeholder=i)}};for(const l of e)l.addEventListener("click",n,!1),l.addEventListener("mouseover",o,!1),l.addEventListener("mouseout",s,!1)}}}return!0};injectFFZPicker=async(e=defaultElement)=>{if(Utils.invalidElement(e))return!1;const t=e.querySelector("yt-emoji-picker-renderer.yt-live-chat-message-input-renderer > #categories-wrapper > #categories");if(!Utils.exists(t))return!1;if(Utils.exists(t.querySelector("#ffzEmojis")))return!1;t.children[0].insertAdjacentHTML("afterend",'<yt-emoji-picker-category-renderer class="style-scope yt-emoji-picker-renderer" aria-live="polite" role="listbox" tabindex="0" aria-label="FFZ" id="ffzEmojis" aria-activedescendant="aria-ffzEmojis"><yt-formatted-string id="title" class="style-scope yt-emoji-picker-category-renderer">FFZ</yt-formatted-string><div id="emoji" role="listbox" tabindex="0" class="style-scope yt-emoji-picker-category-renderer imgList" aria-label=""><dom-repeat id="repeat" class="style-scope yt-emoji-picker-category-renderer"><template is="dom-repeat"></template></dom-repeat></div></yt-emoji-picker-category-renderer>');const r=t.querySelector("#ffzEmojis");if(Utils.exists(r)){r.setAttribute("aria-activedescendant","aria-ffzEmojis"),r.setAttribute("aria-label","FFZ"),r.querySelector("yt-formatted-string").innerText="FFZ";const i=r.querySelector('#emoji[role="listbox"]'),a=this.emojis.filter(t=>"ffz"===t.provider);if(Utils.exists(i)){let t="";for(const c of a)t+=`<img height="24" role="option" width="24" class="style-scope yt-emoji-picker-category-renderer ffzEmoji" src="https://cdn.betterttv.net/frankerfacez_emote/${c.id}/1" loading="eager" aria-selected="false" aria-label="${c.code}" label="${c.code}" alt="${c.code}" id="ffx-${c.id}" />`;i.insertAdjacentHTML("afterbegin",t);e=i.getElementsByClassName("ffzEmoji");if(0<e.length){let i="Search emoji";var n=t=>{const e=t||window.event,r=t.currentTarget.getAttribute("label");var i=a.find(t=>t.code===r);if(i){const n=t.currentTarget.closest("yt-live-chat-message-input-renderer > #container");if(Utils.exists(n)){const o=n.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(o)&&(t=o.querySelector("#input"),Utils.exists(t)&&(o.setAttribute("has-text",""),o.dispatchEvent(new Event("character-count-changed")),o?.insertEmoji({isCustomEmoji:!0,shortcuts:[":"+i.code],emojiId:i.code}),o?.focusAtEnd()))}}e.preventDefault()},o=t=>{const e=t.currentTarget.getAttribute("label");if(a.find(t=>t.code===e)){const r=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(r)){let t=r.querySelector("input");Utils.exists(t)&&(i=""+t.placeholder,t.placeholder=""+e)}}},s=t=>{const e=t.currentTarget.closest("yt-emoji-picker-renderer").querySelector("#search-panel");if(Utils.exists(e)){let t=e.querySelector("input");Utils.exists(t)&&(t.placeholder=i)}};for(const l of e)l.addEventListener("click",n,!1),l.addEventListener("mouseover",o,!1),l.addEventListener("mouseout",s,!1)}}}return!0};injectSuggestion=(e={...defaultChatElements},t={provider:"",id:"",code:"",src:""},r=":")=>{var i=`emoji-suggest-${t.provider}-`+t.id;const n=e.dropdownContent;if(!Utils.invalidElement(n)&&!Utils.exists(n.querySelector("#"+i))){const o=document.createElement("ytg-live-chat-text-input-field-suggestion"),s=document.createElement("tp-yt-paper-item"),a=document.createElement("img");r={emoji:!0,image:t.src,alt:t.code,text:`:${t.code}:`,author:t.provider,authorType:t.provider,textToReplaceWhenSelected:r.startsWith(":")?r:":"+r,textToInsertWhenSelected:t.code};o.classList.add("style-scope","yt-live-chat-text-input-field-renderer"),Utils.setAttributes(o,{id:i,ytg:""}),Utils.setDataAttributes(o,{...r}),s.classList.add("style-scope","yt-live-chat-text-input-field-suggestion"),s.innerText=`:${t.code}:`,s.addEventListener("mouseover",()=>{o.setAttribute("active","")}),s.addEventListener("mouseout",()=>{o.removeAttribute("active")}),Utils.setAttributes(s,{role:"option",tabindex:"0","aria-disabled":"false"}),s.addEventListener("click",()=>{o.removeAttribute("active");const t=e.textInputFieldRenderer??inputContainer.querySelector("yt-live-chat-message-input-renderer #input-container > yt-live-chat-text-input-field-renderer");Utils.exists(t)&&(Utils.getDataAttributes(o),t.setAttribute("has-text",""),t.dispatchEvent(new Event("character-count-changed")))}),a.classList.add("style-scope","yt-live-chat-text-input-field-suggestion"),Utils.setAttributes(a,{src:t.src,alt:t.code}),s.prepend(a),o.appendChild(s),n.appendChild(o)}};injectSuggestions=(r={...defaultChatElements},e="")=>{var i=(t=void 0)=>{if(Utils.exists(r.dropdownContent))for(const e of r.dropdownContent.children)Utils.exists(e)&&(e.removeAttribute("active"),e.querySelector("tp-yt-paper-item").removeAttribute("active"),("YTG-LIVE-CHAT-TEXT-INPUT-FIELD-SUGGESTION"===e.tagName||t&&!e.innerText.toLowerCase().startsWith((":"+t).toLowerCase()))&&r.dropdownContent.removeChild(e));return!0};if(e.includes(":")){var n=e.trim().split(":").pop().split(" ")[0];if(!(n.length<2)){e=this.getFromCode(n);if(0<e.length){if(Utils.exists(r.dropdownContent)){i(n);for(const o of e)this.injectSuggestion(r,o,n);let t=Array.from(r.dropdownContent.children).at(-1);Utils.exists(t)&&(t.setAttribute("active",""),t.querySelector("tp-yt-paper-item").setAttribute("active","")),r.dropdownContent.scrollTop=r.dropdownContent.scrollHeight,r.ironDropdown.style.setProperty("display","")}}else i(n)}}else"none"!==r.ironDropdown.style.display&&(i(),r.ironDropdown.style.setProperty("display","none"))};addToMessage=async t=>{var e,r=/[&\/\\#,+()$~%.'":*?<>{}]/gim;for(e of Utils.splitMessage(t)){e=e.replace(r,"");var i=await this.getEmote(e);i&&!excludesWords.includes(e.toLowerCase())&&(t=t.replace(new RegExp(`(?!")${e}(?!")`),Utils.emoteToImage(i)))}return t};insertTo=async(t=defaultElement)=>(Utils.invalidElement(t)||(t.innerHTML=await this.addToMessage(t.innerHTML)),t);clean=t=>t.filter(t=>!excludesWords.includes(t.code.toLowerCase()));mergeFFZ=(t,e)=>{this.ffz=this.ffz.concat(t.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)))};mergeBTTV=(t,e)=>{this.bttv=this.bttv.concat(t.channelEmotes.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)),t.sharedEmotes.map(t=>("restrictions"in t||(t.restrictions={channels:[],games:[]}),-1==t.restrictions.channels.indexOf(e)&&t.restrictions.channels.push(e),t)))};loadFFZ=async(e="")=>{if(!this.chatSettings.ffzEmotes)return!(this.ffz=[]);try{var t,r=supportedChannels.find(t=>t.youtube.name===e.toLowerCase());void 0!==r&&(t=await Utils.fetchJSON("https://api.betterttv.net/3/cached/frankerfacez/users/twitch/"+r.twitch.id),this.mergeFFZ(t,r.twitch.id))}catch(t){}try{const i=await Utils.fetchJSON("https://api.betterttv.net/3/cached/frankerfacez/emotes/global");this.ffz=this.ffz.concat(i.map(t=>(t.global=!0,t)))}catch(t){}return this.ffz=this.clean(this.ffz),!0};loadBTTV=async(e="")=>{if(!this.chatSettings.bttvEmotes)return!(this.bttv=[]);try{var t,r=supportedChannels.find(t=>t.youtube.name===e.toLowerCase());void 0!==r&&(t=await Utils.fetchJSON("https://api.betterttv.net/3/cached/users/twitch/"+r.twitch.id),this.mergeBTTV(t,r.twitch.id))}catch(t){}try{const i=await Utils.fetchJSON("https://api.betterttv.net/3/cached/emotes/global");this.bttv=this.bttv.concat(i.map(t=>(t.global=!0,t)))}catch(t){}return this.bttv=this.clean(this.bttv),!0};load=async(t="",e={...defaultChatElements})=>{this.chatElements=e;try{0===this.bttv.length&&await this.loadBTTV(t)}catch{}try{0===this.ffz.length&&await this.loadFFZ(t)}catch{}try{await this.build()}catch{}return!0};emojiPickerObserver=new MutationObserver(t=>{for(const e of t){const r=e.target;Utils.exists(r)&&r.hasAttribute("selected")&&(this.chatSettings.ffzEmotes&&this.injectFFZPicker(r),this.chatSettings.bttvEmotes&&this.injectBTTVPicker(r),this.emojiPickerObserver.disconnect())}})}