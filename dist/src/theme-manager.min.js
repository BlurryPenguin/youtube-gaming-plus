'use strict';
(function () {
	function e(e) {
		return !(!s.test(e) || a.test(e));
	}
	function t() {
		o ||
			chrome.storage.sync.get(c, function (e) {
				e && e[c] && e[c].darkTheme && n(), (o = !0);
			});
	}
	function n() {
		var e = document.createElement('link');
		(e.href = chrome.extension.getURL('styles/base.min.css')),
			(e.type = 'text/css'),
			(e.rel = 'stylesheet'),
			document.getElementsByTagName('head')[0].appendChild(e);
		var t = document.createElement('link');
		(t.href = chrome.extension.getURL('styles/channel.min.css')),
			(t.type = 'text/css'),
			(t.rel = 'stylesheet'),
			document.getElementsByTagName('head')[0].appendChild(t);
	}
	var s = /https:\/\/www.youtube.com\/watch?v=(.*?)/i,
		a = /https:\/\/www.smashcast.tv\/api/i,
		c = 'smashcastPlus.generalSettings',
		o = !1;
	e(document.location.href) && t(),
		chrome.runtime.onMessage.addListener(function (n, s, a) {
			n.type &&
				'smashcast+' === n.type &&
				n.system &&
				'theatreMode' === n.system &&
				(n.action && 'tab_change' === n.action
					? e(document.location.href) && t()
					: n.action && 'loadThemeSettings' === n.action && n.data && e(document.location.href) && t());
		}),
		chrome.storage.onChanged.addListener(function (n, s) {
			for (var a in n) a === c && e(document.location.href) && t();
		});
})();
